{"version":3,"file":"8222.bundle.js","mappings":"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","sources":["webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/@jupyterlab/pdf-extension/lib/index.js"],"sourcesContent":["// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n/**\n * @packageDocumentation\n * @module pdf-extension\n */\nimport { PromiseDelegate } from '@lumino/coreutils';\nimport { DisposableDelegate } from '@lumino/disposable';\nimport { Widget } from '@lumino/widgets';\n/**\n * The MIME type for PDF.\n */\nconst MIME_TYPE = 'application/pdf';\n/**\n * A class for rendering a PDF document.\n */\nexport class RenderedPDF extends Widget {\n    constructor() {\n        super();\n        this._base64 = '';\n        this._disposable = null;\n        this._ready = new PromiseDelegate();\n        this.addClass('jp-PDFContainer');\n        // We put the object in an iframe, which seems to have a better chance\n        // of retaining its scroll position upon tab focusing, moving around etc.\n        const iframe = document.createElement('iframe');\n        // Sets iframe loading to lazy\n        iframe.setAttribute('loading', 'lazy');\n        this.node.appendChild(iframe);\n        // The iframe content window is not available until the onload event.\n        iframe.onload = () => {\n            const body = iframe.contentWindow.document.createElement('body');\n            body.style.margin = '0px';\n            iframe.contentWindow.document.body = body;\n            this._object = iframe.contentWindow.document.createElement('object');\n            // work around for https://discussions.apple.com/thread/252247740\n            // Detect if running on Desktop Safari\n            if (!window.safari) {\n                this._object.type = MIME_TYPE;\n            }\n            this._object.width = '100%';\n            this._object.height = '100%';\n            body.appendChild(this._object);\n            this._ready.resolve(void 0);\n        };\n    }\n    /**\n     * Render PDF into this widget's node.\n     */\n    async renderModel(model) {\n        await this._ready.promise;\n        const data = model.data[MIME_TYPE];\n        if (!data ||\n            (data.length === this._base64.length && data === this._base64)) {\n            // If there is no data, or if the string has not changed, we do not\n            // need to re-parse the data and rerender. We do, however, check\n            // for a fragment if the user wants to scroll the output.\n            if (model.metadata.fragment && this._object.data) {\n                const url = this._object.data;\n                this._object.data = `${url.split('#')[0]}${model.metadata.fragment}`;\n            }\n            // For some opaque reason, Firefox seems to loose its scroll position\n            // upon unhiding a PDF. But triggering a refresh of the URL makes it\n            // find it again. No idea what the reason for this is.\n            if (Private.IS_FIREFOX) {\n                this._object.data = this._object.data; // eslint-disable-line\n            }\n            return Promise.resolve(void 0);\n        }\n        this._base64 = data;\n        const blob = Private.b64toBlob(data, MIME_TYPE);\n        // Release reference to any previous object url.\n        if (this._disposable) {\n            this._disposable.dispose();\n        }\n        let objectUrl = URL.createObjectURL(blob);\n        if (model.metadata.fragment) {\n            objectUrl += model.metadata.fragment;\n        }\n        this._object.data = objectUrl;\n        // Set the disposable release the object URL.\n        this._disposable = new DisposableDelegate(() => {\n            try {\n                URL.revokeObjectURL(objectUrl);\n            }\n            catch (error) {\n                /* no-op */\n            }\n        });\n        return;\n    }\n    /**\n     * Handle a `before-hide` message.\n     */\n    onBeforeHide() {\n        // Dispose of any URL fragment before hiding the widget\n        // so that it is not remembered upon show. Only Firefox\n        // seems to have a problem with this.\n        if (Private.IS_FIREFOX) {\n            this._object.data = this._object.data.split('#')[0];\n        }\n    }\n    /**\n     * Dispose of the resources held by the pdf widget.\n     */\n    dispose() {\n        if (this._disposable) {\n            this._disposable.dispose();\n        }\n        super.dispose();\n    }\n}\n/**\n * A mime renderer factory for PDF data.\n */\nexport const rendererFactory = {\n    safe: false,\n    mimeTypes: [MIME_TYPE],\n    defaultRank: 100,\n    createRenderer: options => new RenderedPDF()\n};\nconst extensions = [\n    {\n        id: '@jupyterlab/pdf-extension:factory',\n        description: 'Adds renderer for PDF content.',\n        rendererFactory,\n        dataType: 'string',\n        documentWidgetFactoryOptions: {\n            name: 'PDF',\n            // TODO: translate label\n            modelName: 'base64',\n            primaryFileType: 'PDF',\n            fileTypes: ['PDF'],\n            defaultFor: ['PDF']\n        }\n    }\n];\nexport default extensions;\n/**\n * A namespace for PDF widget private data.\n */\nvar Private;\n(function (Private) {\n    /**\n     * A flag for determining whether the user is using Firefox.\n     * There are some different PDF viewer behaviors on Firefox,\n     * and we try to address them with this. User agent string parsing\n     * is *not* reliable, so this should be considered a best-effort test.\n     */\n    Private.IS_FIREFOX = /Firefox/.test(navigator.userAgent);\n    /**\n     * Convert a base64 encoded string to a Blob object.\n     * Modified from a snippet found here:\n     * https://stackoverflow.com/questions/16245767/creating-a-blob-from-a-base64-string-in-javascript\n     *\n     * @param b64Data - The base64 encoded data.\n     *\n     * @param contentType - The mime type of the data.\n     *\n     * @param sliceSize - The size to chunk the data into for processing.\n     *\n     * @returns a Blob for the data.\n     */\n    function b64toBlob(b64Data, contentType = '', sliceSize = 512) {\n        const byteCharacters = atob(b64Data);\n        const byteArrays = [];\n        for (let offset = 0; offset < byteCharacters.length; offset += sliceSize) {\n            const slice = byteCharacters.slice(offset, offset + sliceSize);\n            const byteNumbers = new Array(slice.length);\n            for (let i = 0; i < slice.length; i++) {\n                byteNumbers[i] = slice.charCodeAt(i);\n            }\n            const byteArray = new Uint8Array(byteNumbers);\n            byteArrays.push(byteArray);\n        }\n        return new Blob(byteArrays, { type: contentType });\n    }\n    Private.b64toBlob = b64toBlob;\n})(Private || (Private = {}));\n//# sourceMappingURL=index.js.map"],"names":["MIME_TYPE","RenderedPDF","Widget","constructor","super","this","_base64","_disposable","_ready","PromiseDelegate","addClass","iframe","document","createElement","setAttribute","node","appendChild","onload","body","contentWindow","style","margin","_object","window","safari","type","width","height","resolve","renderModel","model","promise","data","length","metadata","fragment","url","split","Private","IS_FIREFOX","Promise","blob","b64toBlob","dispose","objectUrl","URL","createObjectURL","DisposableDelegate","revokeObjectURL","error","onBeforeHide","rendererFactory","safe","mimeTypes","defaultRank","createRenderer","options","id","description","dataType","documentWidgetFactoryOptions","name","modelName","primaryFileType","fileTypes","defaultFor","test","navigator","userAgent","b64Data","contentType","sliceSize","byteCharacters","atob","byteArrays","offset","slice","byteNumbers","Array","i","charCodeAt","byteArray","Uint8Array","push","Blob"],"sourceRoot":""}