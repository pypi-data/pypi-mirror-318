(self.webpackChunk_JUPYTERLAB_CORE_OUTPUT=self.webpackChunk_JUPYTERLAB_CORE_OUTPUT||[]).push([[6541],{26541:()=>{window.RevealChalkboard=window.RevealChalkboard||{id:"RevealChalkboard",init:function(e){t(e)},configure:function(e){configure(e)},toggleNotesCanvas:function(){toggleNotesCanvas()},toggleChalkboard:function(){toggleChalkboard()},colorIndex:function(){colorIndex()},colorNext:function(){colorNext()},colorPrev:function(){colorPrev()},clear:function(){clear()},reset:function(){reset()},resetAll:function(){resetAll()},updateStorage:function(){updateStorage()},getData:function(){return getData()},download:function(){download()}};var e=function(){var e;if(document.currentScript)e=document.currentScript.src;else{var t=document.querySelector('script[src$="/chalkboard/plugin.js"]');t&&(e=t.src)}return void 0===e?"":e.slice(0,e.lastIndexOf("/")+1)}();const t=function(t){var n,a,o=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){o=!0}}))}catch(e){}var r,i=!1,s=3,l=7,d=1,c=[!0,!1],u={src:e+"img/sponge.png",radius:20},h=[{color:"rgba(100,100,100,1)",cursor:"url("+e+"img/boardmarker-black.png), auto"},{color:"rgba(30,144,255, 1)",cursor:"url("+e+"img/boardmarker-blue.png), auto"},{color:"rgba(220,20,60,1)",cursor:"url("+e+"img/boardmarker-red.png), auto"},{color:"rgba(50,205,50,1)",cursor:"url("+e+"img/boardmarker-green.png), auto"},{color:"rgba(255,140,0,1)",cursor:"url("+e+"img/boardmarker-orange.png), auto"},{color:"rgba(150,0,20150,1)",cursor:"url("+e+"img/boardmarker-purple.png), auto"},{color:"rgba(255,220,0,1)",cursor:"url("+e+"img/boardmarker-yellow.png), auto"}],g=[{color:"rgba(255,255,255,0.5)",cursor:"url("+e+"img/chalk-white.png), auto"},{color:"rgba(96, 154, 244, 0.5)",cursor:"url("+e+"img/chalk-blue.png), auto"},{color:"rgba(237, 20, 28, 0.5)",cursor:"url("+e+"img/chalk-red.png), auto"},{color:"rgba(20, 237, 28, 0.5)",cursor:"url("+e+"img/chalk-green.png), auto"},{color:"rgba(220, 133, 41, 0.5)",cursor:"url("+e+"img/chalk-orange.png), auto"},{color:"rgba(220,0,220,0.5)",cursor:"url("+e+"img/chalk-purple.png), auto"},{color:"rgba(255,220,0,0.5)",cursor:"url("+e+"img/chalk-yellow.png), auto"}],f={toggleNotesCanvas:{keyCode:67,key:"C",description:"Toggle notes canvas"},toggleChalkboard:{keyCode:66,key:"B",description:"Toggle chalkboard"},clear:{keyCode:46,key:"DEL",description:"Clear drawings on slide"},resetAll:{keyCode:8,key:"BACKSPACE",description:"Reset all drawings"},colorNext:{keyCode:88,key:"X",description:"Next color"},colorPrev:{keyCode:89,key:"Y",description:"Previous color"},download:{keyCode:68,key:"D",description:"Download drawings"}},v="chalkboard",p=[0,0],m=!1,b=!1,y=!0,w=!0,k=800,C=!1,E="broadcast",x=O(t.getConfig().chalkboard||{});if(x.keyBindings)for(var S in x.keyBindings)f[S]=x.keyBindings[S];function O(t){return(t.boardmarkerWidth||t.penWidth)&&(s=t.boardmarkerWidth||t.penWidth),t.chalkWidth&&(l=t.chalkWidth),t.chalkEffect&&(d=t.chalkEffect),t.rememberColor&&(c=t.rememberColor),t.eraser&&(u=t.eraser),t.boardmarkers&&(h=t.boardmarkers),t.chalks&&(g=t.chalks),t.theme&&(v=t.theme),"whiteboard"===v?(n=["rgba(127,127,127,.1)",e+"img/whiteboard.png"],a=[de,de],pens=[h,h],i={color:"rgb(127,127,255,0.1)",distance:40,width:2}):(n=["rgba(127,127,127,.1)",e+"img/blackboard.png"],a=[de,ce],pens=[h,g],i={color:"rgb(50,50,10,0.5)",distance:80,width:2}),t.background&&(n=t.background),null!=t.grid&&(i=t.grid),null!=t.toggleChalkboardButton&&(m=t.toggleChalkboardButton),null!=t.toggleNotesButton&&(b=t.toggleNotesButton),null!=t.colorButtons&&(y=t.colorButtons),null!=t.boardHandle&&(w=t.boardHandle),t.transition&&(k=t.transition),null!=t.readOnly&&(C=t.readOnly),t.messageType&&(E=t.messageType),L&&(t.theme||t.background||t.grid)&&(document.getElementById(L[1].id).style.background='url("'+n[1]+'") repeat',fe(1),ve()),t}function T(e){document.querySelector("section[data-markdown]:not([data-markdown-parsed])")||document.querySelector('code[data-line-numbers*="|"]')?(console.log("Wait for markdown to be parsed and code to be highlighted"),setTimeout(T,500,e)):e()}function D(e){null!==$?e():(console.log("Wait for drawings to be loaded"),setTimeout(D,500,e))}m&&(console.warn("toggleChalkboardButton is deprecated, use customcontrols plugin instead!"),(r=document.createElement("div")).className="chalkboard-button",r.id="toggle-chalkboard",r.style.visibility="visible",r.style.position="absolute",r.style.zIndex=30,r.style.fontSize="24px",r.style.left=m.left||"30px",r.style.bottom=m.bottom||"30px",r.style.top=m.top||"auto",r.style.right=m.right||"auto",r.innerHTML='<a href="#" title="Toggle chalkboard ('+f.toggleChalkboard.key+')" onclick="RevealChalkboard.toggleChalkboard(); return false;"><i class="fa fa-pen-square"></i></a>',document.querySelector(".reveal").appendChild(r)),b&&(console.warn("toggleNotesButton is deprecated, use customcontrols plugin instead!"),(r=document.createElement("div")).className="chalkboard-button",r.id="toggle-notes",r.style.position="absolute",r.style.zIndex=30,r.style.fontSize="24px",r.style.left=b.left||"70px",r.style.bottom=b.bottom||"30px",r.style.top=b.top||"auto",r.style.right=b.right||"auto",r.innerHTML='<a href="#" title="Toggle slide annotation ('+f.toggleNotesCanvas.key+')" onclick="RevealChalkboard.toggleNotesCanvas(); return false;"><i class="fa fa-pen"></i></a>',document.querySelector(".reveal").appendChild(r));var L=[{id:"notescanvas"},{id:"chalkboard"}];F(0),F(1);var M=0,A=0,P=0,q=0,N=null,I=null,B=!1,R=!1,W=Date.now(),Y={h:0,v:0},X=[[],[]],H=null,U=null,z=null,_=!1;function j(e,t){(!0===t||t>e.length)&&(t=e.length);var n=document.createElement("div");n.classList.add("palette");for(var a=document.createElement("ul"),o=0;o<t;o++){var r=document.createElement("li");r.setAttribute("data-color",o),r.innerHTML='<i class="fa fa-square"></i>',r.style.color=e[o].color,r.addEventListener("click",(function(e){for(var t=e.target;!t.hasAttribute("data-color");)t=t.parentElement;Pe(parseInt(t.getAttribute("data-color")))})),r.addEventListener("touchstart",(function(e){for(var t=e.target;!t.hasAttribute("data-color");)t=t.parentElement;Pe(parseInt(t.getAttribute("data-color")))})),a.appendChild(r)}return n.appendChild(a),n}function J(e){me(e,!0);var t=new CustomEvent(E);t.content={sender:"chalkboard-plugin",type:"selectboard",timestamp:Date.now()-W,mode:M,board:A},document.dispatchEvent(t)}function F(e){var a=document.createElement("div");if(a.id=L[e].id,a.classList.add("overlay"),a.setAttribute("data-prevent-swipe","true"),a.oncontextmenu=function(){return!1},a.style.cursor=pens[e][p[e]].cursor,L[e].width=window.innerWidth,L[e].height=window.innerHeight,L[e].scale=1,L[e].xOffset=0,L[e].yOffset=0,"0"==e){a.style.background="rgba(0,0,0,0)",a.style.zIndex=24,a.style.opacity=1,a.style.visibility="visible",a.style.pointerEvents="none",document.querySelector(".slides");var r=t.getConfig().width/t.getConfig().height;L[e].width>L[e].height*r?L[e].xOffset=(L[e].width-L[e].height*r)/2:L[e].height>L[e].width/r&&(L[e].yOffset=(L[e].height-L[e].width/r)/2),y&&((i=j(h,y)).style.visibility="hidden",a.appendChild(i))}else{if(a.style.background='url("'+n[e]+'") repeat',a.style.zIndex=26,a.style.opacity=0,a.style.visibility="hidden",y){var i=j(g,y);a.appendChild(i)}if(w){var s=document.createElement("div");s.classList.add("boardhandle"),s.innerHTML='<ul><li><a id="previousboard" href="#" title="Previous board"><i class="fas fa-chevron-up"></i></a></li><li><a id="nextboard" href="#" title="Next board"><i class="fas fa-chevron-down"></i></a></li></ul>',s.querySelector("#previousboard").addEventListener("click",(function(e){e.preventDefault(),J(A-1)})),s.querySelector("#nextboard").addEventListener("click",(function(e){e.preventDefault(),J(A+1)})),s.querySelector("#previousboard").addEventListener("touchstart",(function(e){e.preventDefault(),J(A-1)})),s.querySelector("#nextboard").addEventListener("touchstart",(function(e){e.preventDefault(),J(A+1)})),a.appendChild(s)}}var l=document.createElement("img");l.src=u.src,l.id="sponge",l.style.visibility="hidden",l.style.position="absolute",a.appendChild(l),L[e].sponge=l;var d=document.createElement("canvas");d.width=L[e].width,d.height=L[e].height,d.setAttribute("data-chalkboard",e),d.style.cursor=pens[e][p[e]].cursor,a.appendChild(d),L[e].canvas=d,L[e].context=d.getContext("2d"),function(e){e.addEventListener("touchstart",(function(e){if(e.preventDefault(),!C&&e.target.getAttribute("data-chalkboard")==M){var t=L[M].scale,n=L[M].xOffset,a=L[M].yOffset,o=e.touches[0];P=o.pageX,q=o.pageY,Oe((P-n)/t,(q-a)/t),H=setTimeout(xe,500,(P-n)/t,(q-a)/t)}}),!!o&&{passive:!1}),e.addEventListener("touchmove",(function(e){if(e.preventDefault(),clearTimeout(H),H=null,B||R){var t,n=L[M].scale,a=L[M].xOffset,o=L[M].yOffset,r=e.touches[0];P=r.pageX,(q=r.pageY)<L[M].height&&P<L[M].width&&"erase"==event.type&&(L[M].sponge.style.left=P-u.radius+"px",L[M].sponge.style.top=q-u.radius+"px"),B?(Te((N-a)/n,(I-o)/n,(P-a)/n,(q-o)/n,p[M]),(t=new CustomEvent(E)).content={sender:"chalkboard-plugin",type:"draw",timestamp:Date.now()-W,mode:M,board:A,fromX:(N-a)/n,fromY:(I-o)/n,toX:(P-a)/n,toY:(q-o)/n,color:p[M]},document.dispatchEvent(t),N=P,I=q):(Se((P-a)/n,(q-o)/n),(t=new CustomEvent(E)).content={sender:"chalkboard-plugin",type:"erase",timestamp:Date.now()-W,mode:M,board:A,x:(P-a)/n,y:(q-o)/n},document.dispatchEvent(t))}}),!1),e.addEventListener("touchend",(function(e){e.preventDefault(),clearTimeout(H),H=null,L[M].sponge.style.visibility="hidden",De()}),!1),e.addEventListener("mousedown",(function(e){if(e.preventDefault(),!C&&e.target.getAttribute("data-chalkboard")==M){var t=L[M].scale,n=L[M].xOffset,a=L[M].yOffset;if(P=e.pageX,q=e.pageY,2==e.button||1==e.button){xe((P-n)/t,(q-a)/t);var o=new CustomEvent(E);o.content={sender:"chalkboard-plugin",type:"erase",timestamp:Date.now()-W,mode:M,board:A,x:(P-n)/t,y:(q-a)/t},document.dispatchEvent(o)}else Oe((P-n)/t,(q-a)/t)}})),e.addEventListener("mousemove",(function(e){if(e.preventDefault(),B||R){var t,n=L[M].scale,a=L[M].xOffset,o=L[M].yOffset;P=e.pageX,q=e.pageY,B?(Te((N-a)/n,(I-o)/n,(P-a)/n,(q-o)/n,p[M]),(t=new CustomEvent(E)).content={sender:"chalkboard-plugin",type:"draw",timestamp:Date.now()-W,mode:M,board:A,fromX:(N-a)/n,fromY:(I-o)/n,toX:(P-a)/n,toY:(q-o)/n,color:p[M]},document.dispatchEvent(t),N=P,I=q):(Se((P-a)/n,(q-o)/n),(t=new CustomEvent(E)).content={sender:"chalkboard-plugin",type:"erase",timestamp:Date.now()-W,mode:M,board:A,x:(P-a)/n,y:(q-o)/n},document.dispatchEvent(t))}})),e.addEventListener("mouseup",(function(e){e.preventDefault(),L[M].canvas.style.cursor=pens[M][p[M]].cursor,(B||R)&&(De(),R=!1,L[M].sponge.style.visibility="hidden")}))}(a),document.querySelector(".reveal").appendChild(a),L[e].container=a}var K=[{width:t.getConfig().width,height:t.getConfig().height,data:[]},{width:t.getConfig().width,height:t.getConfig().height,data:[]}],$=null;function G(e){var t=!1;try{for(var n=JSON.parse(e),a=0;a<n.length;a++)L[a].width==n[a].width&&L[a].height==n[a].height||(L[a].scale=Math.min(L[a].width/n[a].width,L[a].height/n[a].height),L[a].xOffset=(L[a].width-n[a].width*L[a].scale)/2,L[a].yOffset=(L[a].height-n[a].height*L[a].scale)/2),x.readOnly&&(L[a].container.style.cursor="default",L[a].canvas.style.cursor="default");t=!0,K=n}catch(e){console.warn("Cannot initialise storage!")}return t}function Q(e){e?(V(),z=null):(z&&clearTimeout(z),z=setTimeout(Q,1e3,!0))}function V(){var e=JSON.stringify(K);return x.storage&&sessionStorage.setItem(x.storage,e),e}function Z(e){e.time=Date.now()-W,1==M&&(e.board=A);for(var t=te(),n=t.events.length;n>0&&e.time<t.events[n-1].time;)n--;t.events.splice(n,0,e),t.duration=Math.max(t.duration,Date.now()-W)+1,Q()}function ee(){for(var e=0;e<2;e++)for(var t=K[e].data.length-1;t>=0;t--)0==K[e].data[t].events.length&&K[e].data.splice(t,1);return V()}function te(e,n){null==n&&(n=M),e||(e=Y);for(var a=0;a<K[n].data.length;a++)if(K[n].data[a].slide.h===e.h&&K[n].data[a].slide.v===e.v&&K[n].data[a].slide.f===e.f)return K[n].data[a];var o=Number(t.getCurrentSlide().getAttribute("data-pdf-page-number"));return K[n].data.push({slide:e,page:o,events:[],duration:0}),K[n].data[K[n].data.length-1]}function ne(e){e||(e=Y);for(var t=0,n=0;n<2;n++)for(var a=0;a<K[n].data.length;a++)if(K[n].data[a].slide.h===e.h&&K[n].data[a].slide.v===e.v&&K[n].data[a].slide.f===e.f){t=Math.max(t,K[n].data[a].duration);break}return t}x.storage&&($=G(sessionStorage.getItem(x.storage))),$||null==x.src||function(e){var t=new XMLHttpRequest;t.onload=function(){4===t.readyState&&404!=t.status?($=G(t.responseText),V(),console.log("Drawings loaded from file")):(x.readOnly=void 0,C=void 0,console.warn("Failed to get file "+e+". ReadyState: "+t.readyState+", Status: "+t.status),$=!1)},t.open("GET",e,!0);try{t.send()}catch(t){x.readOnly=void 0,C=void 0,console.warn("Failed to get file "+e+". Make sure that the presentation and the file are served by a HTTP server and the file can be found there. "+t),$=!1}}(x.src);var ae=/print-pdf/gi.test(window.location.search);function oe(){for(var e=t.getSlides(),n=0,a=0;a<e.length;a++){e[a].setAttribute("data-pdf-page-number",n.toString());for(var o=e[a].querySelectorAll(".fragment:not([data-fragment-index])").length,r=e[a].querySelectorAll(".fragment[data-fragment-index]"),i=0;i<r.length;i++)Number(r[i].getAttribute("data-fragment-index"))+1>o&&(o=Number(r[i].getAttribute("data-fragment-index"))+1);n+=o+1}}function re(){if(0!=K[1].data.length){console.log("Create printout(s) for "+K[1].data.length+" slides"),L[0].container.style.opacity=0,L[0].container.style.visibility="hidden";var e=new Image;e.onload=function(){for(var n=t.getSlides(),a=K[1].data.length-1;a>=0;a--){console.log("Create printout for slide "+K[1].data[a].slide.h+"."+K[1].data[a].slide.v);var o=se(te(K[1].data[a].slide,1),e);le(n[K[1].data[a].page],o)}},e.src=n[1]}}function ie(e,t,n){var a,o,r,i=t.findIndex((e=>e.board===n));if(-1===i){var s=(a=e,r=(o=document.createElement("canvas")).getContext("2d"),o.width=a.width,o.height=a.height,r.drawImage(a,0,0),o);t.length?n<t[0].board?(i=0,t.unshift({board:n,canvas:s})):n>t[t.length-1].board&&(i=t.length,t.push({board:n,canvas:s})):(i=0,t.push({board:n,canvas:s}))}return t[i].canvas}function se(e,n){var o=t.getConfig().width,r=t.getConfig().height,i=1,s=0,l=0;o==K[1].width&&r==K[1].height||(i=Math.min(o/K[1].width,r/K[1].height),s=(o-K[1].width*i)/2,l=(r-K[1].height*i)/2),M=1,A=0;var d=[],c=document.createElement("canvas");c.width=o,c.height=r;var u=c.getContext("2d");u.fillStyle=u.createPattern(n,"repeat"),u.rect(0,0,o,r),u.fill();for(var h=0;h<e.events.length;h++)switch(e.events[h].type){case"draw":a[1](ie(c,d,A).getContext("2d"),s+e.events[h].x1*i,l+e.events[h].y1*i,s+e.events[h].x2*i,l+e.events[h].y2*i,l+e.events[h].color);break;case"erase":ue(ie(c,d,A).getContext("2d"),s+e.events[h].x*i,l+e.events[h].y*i);break;case"selectboard":me(e.events[h].board);break;case"clear":ie(c,d,A).getContext("2d").clearRect(0,0,o,r),ie(c,d,A).getContext("2d").fill()}return d=d.sort(((e,t)=>e.board>t.board?1:-1)),M=0,d}function le(e,n){for(var a=e.parentElement.parentElement,o=e.parentElement.nextElementSibling,r=0;r<n.length;r++){var i=document.createElement("div");i.classList.add("pdf-page"),i.style.height=t.getConfig().height,i.append(n[r].canvas),null!=o?a.insertBefore(i,o):a.append(i)}}function de(e,t,n,a,o,r){null==r&&(r=p[M]),e.lineWidth=s,e.lineCap="round",e.strokeStyle=h[r].color,e.beginPath(),e.moveTo(t,n),e.lineTo(a,o),e.stroke()}function ce(e,t,n,a,o,r){null==r&&(r=p[M]);var i=l;e.lineWidth=i,e.lineCap="round",e.fillStyle=g[r].color,e.strokeStyle=g[r].color,e.strokeStyle=e.strokeStyle.replace(/[\d\.]+\)$/g,"1)"),e.beginPath(),e.moveTo(t,n),e.lineTo(a,o),e.stroke();for(var s=Math.round(Math.sqrt(Math.pow(a-t,2)+Math.pow(o-n,2))/(5/i)),c=(a-t)/s,u=(o-n)/s,h=0;h<s;h++)if(d>.9*Math.random()){var f=n+h*u,v=t+h*c+(Math.random()-.5)*i*1.2,m=f+(Math.random()-.5)*i*1.2;e.clearRect(v,m,2*Math.random()+2,Math.random()+1)}}function ue(e,t,n){e.save(),e.beginPath(),e.arc(t,n,u.radius,0,2*Math.PI,!1),e.clip(),e.clearRect(t-u.radius-1,n-u.radius-1,2*u.radius+2,2*u.radius+2),e.restore(),1==M&&i&&function(e,t,n){var a=L[1].context;L[1].scale=Math.min(L[1].width/K[1].width,L[1].height/K[1].height),L[1].xOffset=(L[1].width-K[1].width*L[1].scale)/2,L[1].yOffset=(L[1].height-K[1].height*L[1].scale)/2;for(var o=L[1].scale,r=(L[1].xOffset,L[1].yOffset,i.distance*o),s=L[1].width/2-r/2-Math.floor((L[1].width-r)/2/r)*r,l=s+r*Math.ceil((e-n-s)/r);l<=s+r*Math.floor((e+n-s)/r);l+=r)a.beginPath(),a.lineWidth=i.width*o,a.lineCap="round",a.fillStyle=i.color,a.strokeStyle=i.color,a.moveTo(l,t-Math.sqrt(n*n-(e-l)*(e-l))),a.lineTo(l,t+Math.sqrt(n*n-(e-l)*(e-l))),a.stroke();for(var d=L[1].height/2-r/2-Math.floor((L[1].height-r)/2/r)*r,c=d+r*Math.ceil((t-n-d)/r);c<=d+r*Math.floor((t+n-d)/r);c+=r)a.beginPath(),a.lineWidth=i.width*o,a.lineCap="round",a.fillStyle=i.color,a.strokeStyle=i.color,a.moveTo(e-Math.sqrt(n*n-(t-c)*(t-c)),c),a.lineTo(e+Math.sqrt(n*n-(t-c)*(t-c)),c),a.stroke()}(t,n,u.radius)}function he(){clearTimeout(H),H=null,L[0].sponge.style.visibility="hidden",L[1].sponge.style.visibility="hidden",L[1].container.style.opacity=1,L[1].container.style.visibility="visible",M=1}function ge(){clearTimeout(H),H=null,L[0].sponge.style.visibility="hidden",L[1].sponge.style.visibility="hidden",L[1].container.style.opacity=0,L[1].container.style.visibility="hidden",N=null,I=null,M=0}function fe(e){0==e&&clearTimeout(U),L[e].context.clearRect(0,0,L[e].width,L[e].height),1==e&&i&&ve()}function ve(){var e=L[1].context;L[1].scale=Math.min(L[1].width/K[1].width,L[1].height/K[1].height),L[1].xOffset=(L[1].width-K[1].width*L[1].scale)/2,L[1].yOffset=(L[1].height-K[1].height*L[1].scale)/2;for(var t=L[1].scale,n=(L[1].xOffset,L[1].yOffset,i.distance*t),a=L[1].width/2-n/2-Math.floor((L[1].width-n)/2/n)*n;a<L[1].width;a+=n)e.beginPath(),e.lineWidth=i.width*t,e.lineCap="round",e.fillStyle=i.color,e.strokeStyle=i.color,e.moveTo(a,0),e.lineTo(a,L[1].height),e.stroke();for(var o=L[1].height/2-n/2-Math.floor((L[1].height-n)/2/n)*n;o<L[1].height;o+=n)e.beginPath(),e.lineWidth=i.width*t,e.lineCap="round",e.fillStyle=i.color,e.strokeStyle=i.color,e.moveTo(0,o),e.lineTo(L[1].width,o),e.stroke()}function pe(e,t){e>=pens[M].length&&(e=0),p[M]=e,L[M].canvas.style.cursor=pens[M][p[M]].cursor}function me(e,t){A!=e&&(A=e,be(e),t&&Z({type:"selectboard"}))}function be(e){fe(1);for(var t=te(Y,1),n=0;n<t.events.length&&t.events[n].time<Date.now()-W;)e==t.events[n].board&&Ee(1,t.events[n],Date.now()-W),n++}var ye=[];function we(){var e=ye.shift();switch(W=Date.now()-e.content.timestamp,M<e.content.mode?he():M>e.content.mode&&ge(),A!=e.content.board&&be(A=e.content.board),e.content.type){case"showChalkboard":he();break;case"closeChalkboard":ge();break;case"erase":Se(e.content.x,e.content.y);break;case"draw":Te(e.content.fromX,e.content.fromY,e.content.toX,e.content.toY,e.content.color);break;case"clear":Ae();break;case"selectboard":me(e.content.board,!0);break;case"resetSlide":qe();break;case"init":K=e.content.storage;for(var t=0;t<2;t++)L[t].scale=Math.min(L[t].width/K[t].width,L[t].height/K[t].height),L[t].xOffset=(L[t].width-K[t].width*L[t].scale)/2,L[t].yOffset=(L[t].height-K[t].height*L[t].scale)/2;fe(0),fe(1),_||(U=setTimeout(ke,k,ne(),0)),1==M&&0==e.content.mode&&setTimeout(ge,k+50),0==M&&1==e.content.mode&&setTimeout(he,k+50),M=e.content.mode,A=e.content.board}ye.length>0?we():Q()}function ke(e,t){W=Date.now()-e,ge(),M=0,A=0;for(var n=0;n<2;n++){fe(n);for(var a=te(Y,n),o=0;o<a.events.length&&a.events[o].time<Date.now()-W;)Ee(n,a.events[o],e),o++;for(;_&&o<a.events.length;)X[n].push(setTimeout(Ee,a.events[o].time-(Date.now()-W),n,a.events[o],e)),o++}null!=t&&(M=t),1==M&&he()}function Ce(){for(var e=0;e<2;e++){for(var t=0;t<X[e].length;t++)clearTimeout(X[e][t]);X[e]=[]}}function Ee(e,t,n){switch(t.type){case"open":n<=t.time?he():M=1;break;case"close":n<t.time?ge():M=0;break;case"clear":fe(e);break;case"selectboard":me(t.board);break;case"draw":!function(e,t){var n=L[e].context,o=L[e].scale,r=L[e].xOffset,i=L[e].yOffset;a[e](n,r+t.x1*o,i+t.y1*o,r+t.x2*o,i+t.y2*o,t.color)}(e,t);break;case"erase":!function(e,t){var n=L[e].context,a=L[e].scale,o=L[e].xOffset,r=L[e].yOffset;ue(n,o+t.x*a,r+t.y*a)}(e,t)}}function xe(e,t){B=!1,R=!0,L[M].sponge.style.visibility="visible",Se(e,t)}function Se(e,t){var n=L[M].context,a=L[M].scale,o=L[M].xOffset,r=L[M].yOffset;L[M].sponge.style.left=e*a+o-u.radius+"px",L[M].sponge.style.top=t*a+r-2*u.radius+"px",Z({type:"erase",x:e,y:t}),e*a+o>0&&t*a+r>0&&e*a+o<L[M].width&&t*a+r<L[M].height&&ue(n,e*a+o,t*a+r)}function Oe(e,t){B=!0,L[M].context;var n=L[M].scale,a=L[M].xOffset,o=L[M].yOffset;N=e*n+a,I=t*n+o}function Te(e,t,n,o,r){var i=L[M].context,s=L[M].scale,l=L[M].xOffset,d=L[M].yOffset;Z({type:"draw",color:r,x1:e,y1:t,x2:n,y2:o}),e*s+l>0&&t*s+d>0&&e*s+l<L[M].width&&t*s+d<L[M].height&&n*s+l>0&&o*s+d>0&&n*s+l<L[M].width&&o*s+d<L[M].height&&a[M](i,e*s+l,t*s+d,n*s+l,o*s+d,r)}function De(){B=!1}function Le(){var e=Date.now()-W;_||(e=ne());for(var t=0;t<2;t++)L[t].width=window.innerWidth,L[t].height=window.innerHeight,L[t].canvas.width=L[t].width,L[t].canvas.height=L[t].height,L[t].context.canvas.width=L[t].width,L[t].context.canvas.height=L[t].height,L[t].scale=Math.min(L[t].width/K[t].width,L[t].height/K[t].height),L[t].xOffset=(L[t].width-K[t].width*L[t].scale)/2,L[t].yOffset=(L[t].height-K[t].height*L[t].scale)/2;ke(e,M)}function Me(){if(1==M)C||Z({type:"close"}),ge(),(e=new CustomEvent(E)).content={sender:"chalkboard-plugin",type:"closeChalkboard",timestamp:Date.now()-W,mode:0,board:A},document.dispatchEvent(e);else if(he(),!C){var e;Z({type:"open"}),(e=new CustomEvent(E)).content={sender:"chalkboard-plugin",type:"showChalkboard",timestamp:Date.now()-W,mode:1,board:A},document.dispatchEvent(e);var t=0;c[M]&&(t=p[M]),pe(t)}}function Ae(){Z({type:"clear"}),fe(M)}function Pe(e){C||pe(e)}function qe(){var e;W=Date.now(),ge(),fe(0),fe(1),M=1,(e=te()).duration=0,e.events=[],M=0,(e=te()).duration=0,e.events=[],V()}function Ne(e){if(e||confirm("Please confirm to delete chalkboard drawings on this slide!")){Ce(),qe();var t=new CustomEvent(E);t.content={sender:"chalkboard-plugin",type:"resetSlide",timestamp:Date.now()-W,mode:M,board:A},document.dispatchEvent(t)}}for(var S in document.addEventListener("received",(function(e){e.content&&"chalkboard-plugin"==e.content.sender&&(ye.push(e),console.log(JSON.stringify(e))),1==ye.length&&we()})),document.addEventListener("welcome",(function(e){var t=new CustomEvent(E);t.content={sender:"chalkboard-plugin",recipient:e.id,type:"init",timestamp:Date.now()-W,storage:K,mode:M,board:A},document.dispatchEvent(t)})),document.addEventListener("seekplayback",(function(e){Ce(),_&&0!=e.timestamp||ke(e.timestamp)})),document.addEventListener("startplayback",(function(e){Ce(),_=!0,ke(e.timestamp)})),document.addEventListener("stopplayback",(function(e){_=!1,Ce()})),document.addEventListener("startrecording",(function(e){Ne(!0),W=Date.now()})),t.addEventListener("pdf-ready",(function(e){D(re)})),t.addEventListener("ready",(function(e){if(!ae){if(window.addEventListener("resize",Le),W=Date.now()-ne(),Y=t.getIndices(),_||ke(ne(),0),t.isAutoSliding()){var n=new CustomEvent("startplayback");n.timestamp=0,document.dispatchEvent(n)}V(),T(oe)}})),t.addEventListener("slidechanged",(function(e){if(!ae&&(W=Date.now()-ne(),Y=t.getIndices(),ge(),A=0,fe(0),fe(1),_||(U=setTimeout(ke,k,ne(),0)),t.isAutoSliding())){var n=new CustomEvent("startplayback");n.timestamp=0,document.dispatchEvent(n)}})),t.addEventListener("fragmentshown",(function(e){if(!ae)if(W=Date.now()-ne(),Y=t.getIndices(),ge(),A=0,fe(0),fe(1),t.isAutoSliding()){var n=new CustomEvent("startplayback");n.timestamp=0,document.dispatchEvent(n)}else _||ke(ne(),0)})),t.addEventListener("fragmenthidden",(function(e){ae||(W=Date.now()-ne(),Y=t.getIndices(),ge(),A=0,fe(0),fe(1),t.isAutoSliding()?document.dispatchEvent(new CustomEvent("stopplayback")):_||(ke(ne()),ge()))})),t.addEventListener("autoslideresumed",(function(e){var t=new CustomEvent("startplayback");t.timestamp=0,document.dispatchEvent(t)})),t.addEventListener("autoslidepaused",(function(e){document.dispatchEvent(new CustomEvent("stopplayback")),ke(ne(),0)})),this.toggleNotesCanvas=function(){if(!C)if(1==M)Me(),notescanvas.style.background=n[0],notescanvas.style.pointerEvents="auto";else if("none"!=notescanvas.style.pointerEvents)y&&(notescanvas.querySelector(".palette").style.visibility="hidden"),notescanvas.style.background="rgba(0,0,0,0)",notescanvas.style.pointerEvents="none";else{y&&(notescanvas.querySelector(".palette").style.visibility="visible"),notescanvas.style.background=n[0],notescanvas.style.pointerEvents="auto";var e=0;p[M]&&(e=p[M]),pe(e)}},this.toggleChalkboard=Me,this.colorIndex=Pe,this.colorNext=function(){C||pe((p[M]=(p[M]+1)%pens[M].length,p[M]))},this.colorPrev=function(){C||pe((p[M]=(p[M]+(pens[M].length-1))%pens[M].length,p[M]))},this.clear=function(){if(!C){Ae();var e=new CustomEvent(E);e.content={sender:"chalkboard-plugin",type:"clear",timestamp:Date.now()-W,mode:M,board:A},document.dispatchEvent(e)}},this.reset=Ne,this.resetAll=function(e){if(e||confirm("Please confirm to delete all chalkboard drawings!")){Ce(),W=Date.now(),fe(0),fe(1),1==M&&ge(),K=[{width:t.getConfig().width,height:t.getConfig().height,data:[]},{width:t.getConfig().width,height:t.getConfig().height,data:[]}],x.storage&&sessionStorage.setItem(x.storage,null);var n=new CustomEvent(E);n.content={sender:"chalkboard-plugin",type:"init",timestamp:Date.now()-W,storage:K,mode:M,board:A},document.dispatchEvent(n)}},this.download=function(){var e=document.createElement("a");document.body.appendChild(e);try{e.download="chalkboard.json";var t=new Blob([ee()],{type:"application/json"});e.href=window.URL.createObjectURL(t)}catch(t){e.innerHTML+=" ("+t+")"}e.click(),document.body.removeChild(e)},this.updateStorage=V,this.getData=ee,this.configure=O,f)f[S]&&t.addKeyBinding(f[S],RevealChalkboard[S]);return this}}}]);
//# sourceMappingURL=6541.js.map