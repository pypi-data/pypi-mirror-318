import{aE as R,f as h,aF as O,a as i,u as E,v as f,R as t,c as g,m as y,o as N,K as v,D as P,B as x,s as k}from"./index-ohkpUfgU.js";import{D as j}from"./Dialog-MPs8FJy-.js";var F=R();const w=h(F);var I=O();const A=h(I);function U({config:e}){const[s,a]=i.useState(),[n,r]=i.useState(),c=E.getSession(e),{rpcManager:p}=c;i.useEffect(()=>{(async()=>{try{const l=f.readConfObject(e,"adapter"),u=await p.call(e.trackId,"CoreGetInfo",{adapterConfig:l});r(u)}catch(l){console.error(l),a(l)}})()},[e,p]);const d=typeof n=="string"?{header:`<pre>${n.replaceAll("<","&lt;").replaceAll(">","&gt;")}</pre>`}:n||{};return t.createElement(A,{title:"File info"},s?t.createElement(g.ErrorMessage,{error:s}):n===void 0?t.createElement(g.LoadingEllipses,{message:"Loading file data"}):t.createElement(w,{attributes:d}))}const S=1e4,B=y()(e=>({container:{minWidth:800},refNames:{maxHeight:300,overflow:"auto",flexGrow:1,background:e.palette.background.default}})),$=N(function({config:e,onClose:s}){const{classes:a}=B(),[n,r]=i.useState(),[c,p]=i.useState(),[d,l]=i.useState(!1),{rpcManager:u}=E.getSession(e);i.useEffect(()=>{(async()=>{try{const o=await Promise.all([...new Set(v.getConfAssemblyNames(e))].map(async m=>{const D=f.readConfObject(e,"adapter");return[m,await u.call(e.trackId,"CoreGetRefNames",{adapterConfig:D,regions:[{assemblyName:m}]})]}));p(Object.fromEntries(o))}catch(o){console.error(o),r(o)}})()},[e,u]);const b=c?Object.entries(c):[],C=b.flatMap(([o,m])=>[`--- ${o} ---`,...m.slice(0,S),m.length>S?`
Too many refNames to show in browser for ${o}, use "Copy ref names" button to copy to clipboard`:""]).filter(o=>!!o).join(`
`);return t.createElement(g.Dialog,{open:!0,title:"Reference sequence names used in track",onClose:s,maxWidth:"xl"},t.createElement(P,{className:a.container},n?t.createElement(g.ErrorMessage,{error:n}):c===void 0?t.createElement(g.LoadingEllipses,{message:"Loading refNames"}):t.createElement(t.Fragment,null,t.createElement(x,{variant:"contained",onClick:()=>{k(b.flatMap(([o,m])=>[`--- ${o} ---`,...m]).filter(o=>!!o).join(`
`)),l(!0),setTimeout(()=>{l(!1)},1e3)}},d?"Copied to clipboard!":"Copy ref names"),t.createElement("pre",{className:a.refNames},C))))}),L=y()({content:{minWidth:800},button:{float:"right"}});function M(e,s){for(const a in e)a===s?delete e[a]:typeof e[a]=="object"&&M(e[a],s);return e}const T=N(function({config:e}){const[s,a]=i.useState(!1),n=f.readConfObject(e),r=E.getSession(e),{classes:c}=L(),[p,d]=i.useState(!1),l=f.getConf(r,["formatAbout","hideUris"])||f.readConfObject(e,["formatAbout","hideUris"]),{pluginManager:u}=E.getEnv(r),b=u.evaluateExtensionPoint("Core-customizeAbout",{config:{...n,...f.getConf(r,["formatAbout","config"],{config:n}),...f.readConfObject(e,["formatAbout","config"],{config:n})}},{session:r,config:e}),C=u.evaluateExtensionPoint("Core-extraAboutPanel",null,{session:r,config:e});return t.createElement("div",{className:c.content},t.createElement(A,{title:"Configuration"},l?null:t.createElement("span",{className:c.button},t.createElement(x,{variant:"contained",color:"secondary",onClick:()=>{d(!0)}},"Show ref names"),t.createElement(x,{variant:"contained",onClick:()=>{const o=M(structuredClone(n),"baseUri");k(JSON.stringify(o,null,2)),a(!0),setTimeout(()=>{a(!1)},1e3)}},s?"Copied to clipboard!":"Copy config")),t.createElement(w,{attributes:b,omit:["displays","baseUri","refNames","formatAbout"],hideUris:l})),C?t.createElement(A,{title:C.name},t.createElement(C.Component,{config:e})):null,t.createElement(U,{config:e}),p?t.createElement($,{config:e,onClose:()=>{d(!1)}}):null)});function G({config:e,handleClose:s}){const a=E.getSession(e),n=v.getTrackName(e,a),{pluginManager:r}=E.getEnv(a),c=r.evaluateExtensionPoint("Core-replaceAbout",T,{session:a,config:e});return t.createElement(j,{open:!0,onClose:s,title:n,maxWidth:"xl"},t.createElement(c,{config:e}))}export{G as default};
