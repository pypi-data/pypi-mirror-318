import{m as f,o as I,R as e,S as N,U as P,V as R,W as A,X as B,J as H,a as h,P as L,B as m,Y as T,Z as U,_ as W,$ as _,a0 as G,u as g,c as K,D as $,e as O}from"./index-ohkpUfgU.js";import{D as Y}from"./cjs-CNO6nbbG.js";import{C as j,a as z}from"./ColorPicker-O3H7x8oo.js";const F=f()(t=>({closeButton:{position:"absolute",right:t.spacing(1),top:t.spacing(1),color:t.palette.grey[500]}}));function J(t){const o=h.useRef(null);return e.createElement(Y,{nodeRef:o,cancel:'[class*="MuiDialogContent-root"]',onStart:r=>{var i,a;return(a=(i=r.target)===null||i===void 0?void 0:i.className)===null||a===void 0?void 0:a.includes("MuiDialogTitle")}},e.createElement(L,{ref:o,...t}))}const V=I(function(o){const{classes:r}=F(),{title:i,children:a,onClose:n}=o;return e.createElement(N,{...o,PaperComponent:J},e.createElement(P,null,e.createElement(R,{style:{cursor:"move"}},i,n?e.createElement(A,{className:r.closeButton,onClick:()=>{n()}},e.createElement(B,null)):null),e.createElement(H,null),a))});function v(t,o,r=1){const i=o.map(n=>t.findIndex(l=>l.name===n)).sort((n,l)=>n-l);let a=0;for(const n of i){const l=Math.max(a,n-r);l>=a&&t.splice(l,0,t.splice(n,1)[0]),a=a+1}return t}function x(t,o,r=1){const i=o.map(n=>t.findIndex(l=>l.name===n)).sort((n,l)=>l-n);let a=t.length-1;for(const n of i){const l=Math.min(a,n+r);l<=a&&t.splice(l,0,t.splice(n,1)[0]),a=a-1}return t}const X=f()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}});function Z({rows:t,onChange:o,showTips:r}){const{classes:i}=X(),[a,n]=h.useState(null),[l,E]=h.useState([]),{name:Q,color:ee,baseUri:te,...k}=t[0],[y,D]=h.useState("blue"),[b,w]=h.useState({idx:0,field:null});return e.createElement("div",null,e.createElement(m,{disabled:!l.length,onClick:c=>{n(c.currentTarget)}},"Change color of selected items"),e.createElement(m,{onClick:()=>{o(v([...t],l))},disabled:!l.length},e.createElement(T,null),r?"Move selected items up":null),e.createElement(m,{onClick:()=>{o(x([...t],l))},disabled:!l.length},e.createElement(U,null),r?"Move selected items down":null),e.createElement(m,{onClick:()=>{o(v([...t],l,t.length))},disabled:!l.length},e.createElement(W,null),r?"Move selected items to top":null),e.createElement(m,{onClick:()=>{o(x([...t],l,t.length))},disabled:!l.length},e.createElement(_,null),r?"Move selected items to bottom":null),e.createElement(j.ColorPopover,{anchorEl:a,color:y,onChange:c=>{D(c),l.forEach(s=>{const d=t.find(u=>u.name===s);d&&(d.color=c)}),o([...t])},onClose:()=>{n(null)}}),e.createElement("div",{style:{height:400,width:"100%"}},e.createElement(G,{getRowId:c=>c.name,checkboxSelection:!0,disableRowSelectionOnClick:!0,onRowSelectionModelChange:c=>{E(c)},rows:t,rowHeight:25,columnHeaderHeight:33,columns:[{field:"color",headerName:"Color",renderCell:({value:c,id:s})=>e.createElement(z,{color:c||"blue",onChange:d=>{const u=t.find(p=>p.name===s);u&&(u.color=d),o([...t])}})},{field:"name",headerName:"Name",width:g.measureGridWidth(t.map(c=>c.name))},...Object.keys(k).map(c=>({field:c,renderCell:({value:s})=>e.createElement("div",{className:i.cell},e.createElement(K.SanitizedHTML,{html:g.getStr(s)})),width:g.measureGridWidth(t.map(s=>`${s[c]}`))}))],sortModel:[],onSortModelChange:c=>{const s=c[0],d=(b.idx+1)%2,u=s.field||b.field;w({idx:d,field:u}),o(u?[...t].sort((p,M)=>{const C=g.getStr(p[u]),S=g.getStr(M[u]);return d===1?C.localeCompare(S):S.localeCompare(C)}):t)}})))}const q=f()({content:{minWidth:800}});function ae({model:t,handleClose:o}){const{classes:r}=q(),{sources:i}=t,[a,n]=h.useState(structuredClone(i||[])),[l,E]=g.useLocalStorage("multiwiggle-showTips",!1);return e.createElement(V,{open:!0,onClose:o,maxWidth:"xl",title:"Multi-wiggle color/arrangement editor"},e.createElement($,{className:r.content},e.createElement(m,{variant:"contained",style:{float:"right"},onClick:()=>{E(!l)}},l?"Hide tips":"Show tips"),e.createElement("br",null),l?e.createElement(e.Fragment,null,"Helpful tips",e.createElement("ul",null,e.createElement("li",null,"You can select rows in the table with the checkboxes"),e.createElement("li",null,"Multi-select is enabled with shift-click and control-click"),e.createElement("li",null,'The "Move selected items up/down" can re-arrange subtracks'),e.createElement("li",null,"Sorting the data grid itself can also re-arrange subtracks"),e.createElement("li",null,"Changes are applied when you hit Submit"),e.createElement("li",null,"You can click and drag the dialog box to move it on the screen"),e.createElement("li",null,"Columns in the table can be hidden using a vertical '...' menu on the right side of each column"))):null,e.createElement(Z,{rows:a,onChange:n,showTips:l})),e.createElement(O,null,e.createElement(m,{variant:"contained",type:"submit",color:"inherit",onClick:()=>{t.clearLayout(),n(t.sources||[])}},"Clear custom settings"),e.createElement(m,{variant:"contained",color:"secondary",onClick:()=>{o(),n([...t.sources||[]])}},"Cancel"),e.createElement(m,{variant:"contained",color:"primary",type:"submit",onClick:()=>{t.setLayout(a),o()}},"Submit")))}export{ae as default};
