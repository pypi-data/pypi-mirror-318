Metadata-Version: 2.4
Name: openmind
Version: 1.0.0
Summary: openMind is a magicain who takes you to experience the mystery and creativity of AI.
Project-URL: Homepage, https://gitee.com/openmind-ai/openmind
Project-URL: Repository, https://gitee.com/openmind-ai/openmind
Author: The openMind Team
Author-email: dev@public.openmind.cn
License: æœ¨å…°å®½æ¾è®¸å¯è¯ï¼Œ ç¬¬2ç‰ˆ
License-File: LICENSE
License-File: LICENSE-Apache-2.0
Classifier: Development Status :: 1 - Planning
Classifier: Intended Audience :: Developers
Classifier: Intended Audience :: Education
Classifier: Intended Audience :: Science/Research
Classifier: License :: OSI Approved :: Mulan Permissive Software License v2 (MulanPSL-2.0)
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Requires-Python: <3.11,>=3.8
Requires-Dist: datasets<=2.21.0,>=2.18.0
Requires-Dist: decorator
Requires-Dist: docker>=4.34.2
Requires-Dist: einops==0.8.0
Requires-Dist: numpy<2.0.0
Requires-Dist: openmind-hub==0.9.1
Requires-Dist: packaging
Requires-Dist: sentencepiece
Requires-Dist: setuptools==69.5.1
Requires-Dist: tabulate
Requires-Dist: tiktoken
Requires-Dist: tokenizers
Requires-Dist: tqdm
Provides-Extra: ci
Requires-Dist: requests; extra == 'ci'
Provides-Extra: lint
Requires-Dist: black==24.8.0; extra == 'lint'
Requires-Dist: ruff==0.6.1; extra == 'lint'
Provides-Extra: ms
Requires-Dist: mindformers==1.3.0; extra == 'ms'
Requires-Dist: mindspore==2.4.0; extra == 'ms'
Provides-Extra: pt
Requires-Dist: accelerate<=1.0.0rc1,>=0.28.0; extra == 'pt'
Requires-Dist: deepspeed<=0.15.4,>=0.12.6; extra == 'pt'
Requires-Dist: diffusers<=0.31.0,>=0.29.0; extra == 'pt'
Requires-Dist: evaluate==0.4.1; extra == 'pt'
Requires-Dist: lm-eval==0.4.3; extra == 'pt'
Requires-Dist: peft<=0.14.0,>=0.12.0; extra == 'pt'
Requires-Dist: torch-npu==2.1.0.post8; extra == 'pt'
Requires-Dist: torch==2.1.0; extra == 'pt'
Requires-Dist: transformers<=4.45.2,>=4.39.2; extra == 'pt'
Provides-Extra: pt-cpu
Requires-Dist: accelerate<=1.0.0rc1,>=0.28.0; extra == 'pt-cpu'
Requires-Dist: deepspeed<=0.15.4,>=0.12.6; extra == 'pt-cpu'
Requires-Dist: diffusers<=0.31.0,>=0.29.0; extra == 'pt-cpu'
Requires-Dist: evaluate==0.4.1; extra == 'pt-cpu'
Requires-Dist: lm-eval==0.4.3; extra == 'pt-cpu'
Requires-Dist: peft<=0.14.0,>=0.12.0; extra == 'pt-cpu'
Requires-Dist: torch==2.1.0; extra == 'pt-cpu'
Requires-Dist: transformers<=4.45.2,>=4.39.2; extra == 'pt-cpu'
Provides-Extra: test
Requires-Dist: accelerate<=1.0.0rc1,>=0.28.0; extra == 'test'
Requires-Dist: deepspeed<=0.15.4,>=0.12.6; extra == 'test'
Requires-Dist: diffusers<=0.31.0,>=0.29.0; extra == 'test'
Requires-Dist: evaluate==0.4.1; extra == 'test'
Requires-Dist: lm-eval==0.4.3; extra == 'test'
Requires-Dist: peft<=0.14.0,>=0.12.0; extra == 'test'
Requires-Dist: pillow; extra == 'test'
Requires-Dist: pytest; extra == 'test'
Requires-Dist: pytest-cov; extra == 'test'
Requires-Dist: testtools; extra == 'test'
Requires-Dist: torch==2.1.0; extra == 'test'
Requires-Dist: transformers<=4.45.2,>=4.39.2; extra == 'test'
Description-Content-Type: text/markdown

<p align="center"> <img src="./sources/images/logo.png" height="100px" width="350px"> </p>

<p align="center">
    <a href="http://license.coscl.org.cn/MulanPSL2">
        <img alt="Badge" src="https://img.shields.io/badge/license-MulanPSL2-blue.svg">
    </a>
    <a href="https://modelers.cn/">
        <img alt="Visit our community" src="https://img.shields.io/badge/community-modelers.cn-green">
    </a>
    <a>
        <img src="https://app.codacy.com/project/badge/Grade/1710faac5e634acaabfc26b0a778cdde">
    </a>
</p>

---

## ğŸ“ ç®€ä»‹

openMind Libraryæ˜¯ä¸€ä¸ªå¤§æ¨¡å‹å¾®è°ƒå¥—ä»¶ï¼Œé€šè¿‡å‘½ä»¤è¡Œæ¥å£æˆ–SDKåŸç”Ÿæ”¯æŒåœ¨æ˜‡è…¾NPUä¸Šè¿›è¡Œå¾®è°ƒã€æ¨ç†ã€è¯„ä¼°å’Œéƒ¨ç½²ã€‚é€šè¿‡ç®€åŒ–ä½¿ç”¨æµç¨‹ï¼Œå……åˆ†åˆ©ç”¨NPUçš„ç‹¬ç‰¹ä¼˜åŠ¿ï¼Œä¸ºå¤§æ¨¡å‹åº”ç”¨æä¾›é«˜æ•ˆã€å¯æ‰©å±•çš„è§£å†³æ–¹æ¡ˆã€‚

**ä¸ºä»€ä¹ˆä½¿ç”¨ openMind Libraryï¼Ÿ**

åŸºäºTransformersæ¡†æ¶ï¼ŒopenMind Libraryå®ç°äº†é«˜æ•ˆçš„å¾®è°ƒæµç¨‹ã€‚å®ƒé›†æˆäº†PyTorchç”Ÿæ€ä¸­å¸¸ç”¨çš„å·¥å…·åº“åŠŸèƒ½ï¼Œæä¾›æ•°æ®é¢„å¤„ç†ã€æƒé‡åŠ è½½ã€ä½å‚å¾®è°ƒã€é‡åŒ–é€‚é…ä»¥åŠè®­ç»ƒè·Ÿè¸ªç­‰å…¨æµç¨‹çš„ä¸€é”®å¼è§£å†³æ–¹æ¡ˆã€‚æ­¤å¤–ï¼Œåº“å†…èåˆäº†é’ˆå¯¹æ˜‡è…¾NPUçš„ä¼˜åŒ–ç®—å­ï¼Œå¯å¤§å¹…æå‡æ¨¡å‹è®­ç»ƒæ•ˆç‡ã€‚

openMind Libraryæä¾›äº†ç»Ÿä¸€çš„Pipeline SDKï¼Œæä¾›æ›´å¿«é€Ÿã€æ›´é«˜æ•ˆçš„æ¨ç†ä½“éªŒã€‚

æ¨¡å‹éƒ¨ç½²æ–¹é¢ï¼ŒopenMind LibraryåŸºäºLMDeployå’ŒMindIEï¼Œæä¾›å¤šåç«¯éƒ¨ç½²æ”¯æŒï¼Œæå¤§åœ°ç®€åŒ–äº†éƒ¨ç½²æµç¨‹ï¼Œä½¿å¾—æ¨¡å‹éƒ¨ç½²æ›´åŠ ä¾¿æ·ã€‚

openMind Libraryç›®å‰æ”¯æŒçš„ç‰¹æ€§å¦‚ä¸‹ï¼š

- æ¨¡å‹ç±»å‹ï¼šæ”¯æŒQwen2ï¼ŒQwen2.5ç³»åˆ—æ¨¡å‹ï¼Œæ›´å¤šæ¨¡å‹é€‚é…ä¸­
- å¾®è°ƒè®­ç»ƒï¼šSFTè®­ç»ƒ
- é«˜æ•ˆå¾®è°ƒï¼šBF16å¾®è°ƒï¼ŒLoRAå¾®è°ƒï¼Œ4bit QLoRAå¾®è°ƒ
- åˆ†å¸ƒå¼è®­ç»ƒï¼šDDPï¼ŒDeepSpeed
- å¾®è°ƒåŠ é€Ÿï¼šnpu_fusion_attentionèåˆç®—å­ï¼Œnpu_rms_normèåˆç®—å­
- è®­ç»ƒç›‘æ§ï¼šSwanLab
- æ¨ç†ï¼šTransformers/Diffuserså¤šbackendï¼Œtext-generation/text-to-imageå¤šä»»åŠ¡
- éƒ¨ç½²ï¼šLMDeployï¼ŒMindIE
- è¯„ä¼°ï¼šlm_eval

---

## ğŸŒŸ é¡¹ç›®ç‰¹è‰²

openMind Libraryæ”¯æŒQLoRAï¼Œèåˆç®—å­ç­‰è®­ç»ƒåŠ é€Ÿæ‰‹æ®µï¼Œå¸®åŠ©æ‚¨å‡å°‘æ˜¾å­˜å¼€é”€ï¼Œæå‡å¾®è°ƒè®­ç»ƒé€Ÿåº¦ã€‚

<table style="border-collapse: collapse; border-spacing: 0; border: none">
    <tr style="border: none;">
      <td style="border: none; text-align: center;"><img src="./sources/images/memory_optimization.png" alt="Memory Optimization"></td>
      <td style="border: none; text-align: center;"><img  src="./sources/images/performance_boosting.png"  alt="Performance Boosting"></td>
    </tr>
    <tr style="border: none;">
    <td style="border: none; text-align: center; vertical-align: top;">
      <strong>Qwen2.5-7B Full/LoRA/QLoRAæ˜¾å­˜å¼€é”€</strong>
      <br>
      <span style="font-size: 12px; color: gray;">npu=8, per_device_train_batch_size=1, max_length=1024</span>
    </td>
    <td style="border: none; text-align: center; vertical-align: top;">
      <strong>Qwen2.5-7B Full/LoRAæ€§èƒ½å¯¹æ¯”</strong>
      <br>
      <span style="font-size: 12px; color: gray;">npu=8, max_length=1024, train_samples_per_second</span>
    </td>
  </tr>
</table>

---

## ğŸš€ æ›´æ–°æ—¥å¿—

- 2024/12: openMind Library 1.0.0ç‰ˆæœ¬å‘å¸ƒï¼Œæ”¯æŒcliå‘½ä»¤å¯åŠ¨å¾®è°ƒï¼ŒLoRAæƒé‡åˆå¹¶ï¼ŒSwanLabè®­ç»ƒç›‘æ§ï¼ŒLMDeploy/MindIEéƒ¨ç½²ã€‚

---

## ğŸ› ï¸ å®‰è£… 

openMind Libraryæ”¯æŒPyTorchå’ŒMindSporeåŒæ¡†æ¶ï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€æ±‚é€‰æ‹©å®‰è£…å¯¹åº”æ¡†æ¶å’Œä¾èµ–ã€‚è¯·æ³¨æ„**ä¸è¦åŒæ—¶å®‰è£…åŒæ¡†æ¶**ã€‚

ä½¿ç”¨pipè¿›è¡Œå®‰è£…ï¼š

```shell
# ä¸å®‰è£…æ¡†æ¶ï¼Œä»…å®‰è£…openMind Library
pip install openmind

# aarch64ç¯å¢ƒä¸‹å®‰è£…PyTorchæ¡†æ¶åŠå…¶æ¡†æ¶
pip install openmind[pt]

# x86ç¯å¢ƒä¸‹å®‰è£…PyTorchæ¡†æ¶åŠå…¶æ¡†æ¶
pip install openmind[pt] --extra-index-url https://download.pytorch.org/whl/cpu    

# MindSporeæ¡†æ¶åŠå…¶ä¾èµ–
pip install openmind[ms]
```

ä»æºä»£ç å®‰è£…ï¼š

```shell
git clone https://gitee.com/modelers/openmind.git
cd openmind

# ä¸å®‰è£…æ¡†æ¶ï¼Œä»…å®‰è£…openMind Library
pip install -e .

# aarch64ç¯å¢ƒä¸‹å®‰è£…PyTorchæ¡†æ¶åŠå…¶æ¡†æ¶
pip install -e .[pt]

# x86ç¯å¢ƒä¸‹å®‰è£…PyTorchæ¡†æ¶åŠå…¶æ¡†æ¶
pip install -e .[pt] --extra-index-url https://download.pytorch.org/whl/cpu    

# MindSporeæ¡†æ¶åŠå…¶ä¾èµ–
pip install -e .[ms]
```

å…³äºopenMind Libraryçš„å®‰è£…æ­¥éª¤ï¼Œæ¨èç”¨æˆ·å‚è€ƒ[ã€Šå®‰è£…ã€‹](https://modelers.cn/docs/zh/openmind-library/install.html)æ–‡æ¡£ï¼Œä»¥ç¡®ä¿é¡ºåˆ©å¹¶æ­£ç¡®åœ°å®Œæˆå®‰è£…è¿‡ç¨‹ã€‚

---

## ğŸ§° å¿«é€Ÿä¸Šæ‰‹

openMind Libraryæ”¯æŒé€šè¿‡cliæˆ–SDKæ–¹å¼å¯åŠ¨å¾®è°ƒï¼Œæ¨ç†ï¼Œè¯„ä¼°å’Œéƒ¨ç½²ã€‚

### å¾®è°ƒ

openMind Libraryæ”¯æŒé€šè¿‡`openmind-cli train`å‘½ä»¤è¡Œæ–¹å¼è§£æyamlæ–‡ä»¶è¿è¡Œå¾®è°ƒå…¨æµç¨‹ã€‚openMind Libraryä¸ºæ‚¨æä¾›äº†examplesç¤ºä¾‹ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å¿«é€Ÿå¯åŠ¨å¾®è°ƒç¤ºä¾‹ã€‚

#### å…¨å‚å¾®è°ƒ

```shell
openmind-cli train examples/features/train_sft_full.yaml
```

#### LoRAå¾®è°ƒ

```shell
openmind-cli train examples/features/train_sft_lora.yaml
```

#### QLoRAå¾®è°ƒ

QLoRAå¾®è°ƒå¯åŠ¨å‰ï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£…bitandbytesä»“ï¼Œè¯·å‚è€ƒ[å¾®è°ƒQLoRAç« èŠ‚](https://modelers.cn/docs/zh/openmind-library/basic_tutorial/finetune/finetune_pt.html)ä¸­çš„å®‰è£…æŒ‡å¼•å®Œæˆå‰ç½®é…ç½®ã€‚

```shell
openmind-cli train examples/features/train_sft_qlora.yaml
```

#### NPUäº²å’Œç®—å­ä¼˜åŒ–

openMind Libraryç›®å‰é›†æˆäº†npu_fusion_attentionå’Œnpu_rms_normèåˆç®—å­ï¼Œå¯ä»¥æ˜¾è‘—æå‡æ¨¡å‹å¾®è°ƒè®­ç»ƒæ€§èƒ½ã€‚æ‚¨å¯ä»¥å‚è€ƒ[èåˆç®—å­ä½¿èƒ½æ–‡æ¡£](https://modelers.cn/docs/zh/openmind-library/basic_tutorial/fused_ops.html)ä½¿ç”¨è¯¥åŠŸèƒ½æå‡è®­ç»ƒé€Ÿåº¦ã€‚

### æ¨ç†

openMind Libraryæ”¯æŒåŸºäºcliå‘½ä»¤å¿«é€Ÿå¯åŠ¨æ–‡æœ¬ç”Ÿæˆæ¨ç†ã€‚

```shell
openmind-cli run text-generation --framework pt --input "What is AI?"
```

`openmind-cli run`ä¹Ÿæ”¯æŒæ–‡ç”Ÿå›¾æ¨ç†ã€‚

```shell
openmind-cli run  text-to-image  --framework pt --backend diffusers --input "masterpiece, best quality, Cute dragon creature, pokemon style, night, moonlight, dim lighting"
```

å¦‚æœæ‚¨éœ€è¦é›†æˆopenMind Libraryçš„æ¨ç†åŠŸèƒ½ï¼Œæˆ–è€…æœ‰å…¶ä»–ä½¿ç”¨éœ€æ±‚ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨å¯¹åº”çš„SDKæ¥å£è¿›è¡Œè°ƒç”¨ã€‚

```shell
from openmind import pipeline
   
pipe = pipeline(
    task="text-generation",
    model="Baichuan/Baichuan2_7b_chat_pt",
    framework="pt",
    backend="transformers",
    trust_remote_code=True,
    device="npu:0",
)
output = pipe("Give three tips for staying healthy.")
print(output)
```

æ›´å¤šæ¨ç†åŠŸèƒ½ä½¿ç”¨ï¼Œæ‚¨å¯ä»¥å‚è€ƒ[æ¨ç†æ–‡æ¡£](https://modelers.cn/docs/zh/openmind-library/basic_tutorial/pipeline.html)å’Œ[openmind-cli runç« èŠ‚](https://modelers.cn/docs/zh/openmind-library/basic_tutorial/cli.html)ã€‚

### è¯„ä¼°

openMind Libraryé›†æˆäº†lm_evalè¿›è¡Œæ¨¡å‹è¯„ä¼°æ¨ç†ã€‚æ‚¨å¯ä»¥è°ƒç”¨`openmind-cli lmeval`å‘½ä»¤ï¼Œä»é­”ä¹ç¤¾åŒºä¸‹è½½è¯„ä¼°æ•°æ®é›†å®Œæˆè¯„ä¼°ã€‚

```shell
openmind-cli lmeval --model Baichuan/Baichuan2_7b_chat_pt --device npu:0 --tasks arithmetic --batch_size 64 --trust_remote_code 1
```

æ›´å¤šä½¿ç”¨æ–¹å¼å’Œæ”¯æŒçš„è¯„ä¼°æ•°æ®é›†åˆ—è¡¨ï¼Œè¯·æŸ¥çœ‹[openmind-cli lmevalç« èŠ‚](https://modelers.cn/docs/zh/openmind-library/basic_tutorial/cli.html)ã€‚

### éƒ¨ç½²

openMind Libraryæ”¯æŒäº†LMDeployå’ŒMindIEéƒ¨ç½²æ¨¡å‹æœåŠ¡ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡Œç¤ºä¾‹ï¼Œå®ŒæˆæœåŠ¡éƒ¨ç½²ã€‚

- åŸºäºLMDeployéƒ¨ç½²Qwen2-7Bæ¨¡å‹

    ```shell
    openmind-cli deploy AI-Research/Qwen2-7B --backend lmdeploy
    ```
- è°ƒç”¨APIæ¥å£å®Œæˆæ¨ç†

    ```shell
    curl http://127.0.0.1:1025/v1/chat/completions \
          -H 'Content-Type: application/json' \
          -d '{"model": "AI-Research/Qwen2-7B", "messages": "æ¨èä¸€ä¸ªæµ·è¾¹åº¦å‡çš„åœ°æ–¹"}'
    ```

æ›´å¤šdeployæ¥å£ä½¿ç”¨å’ŒMindIEåç«¯ä½¿ç”¨ï¼Œè¯·æŸ¥çœ‹[openmind-cli deployæ–‡æ¡£](https://modelers.cn/docs/zh/openmind-library/basic_tutorial/cli.html)ã€‚

---

## ğŸ“š è´¡çŒ®

1. åœ¨ä¸Šä¼ PRä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‰€æœ‰æµ‹è¯•éƒ½é€šè¿‡ã€‚é¦–å…ˆåœ¨æœ¬åœ°è¿è¡Œå¦‚ä¸‹å‘½ä»¤ã€‚

```shell
# The scripts below run on system default python version by default. If you want to use other python version, set the env
# PY_VERSION. For example, `PY_VERSION=3.8 ./ci/lint.sh`
# Lint check
./ci/lint.sh
# Unit test
./ci/unit_test.sh
# Functional test, Please generate the HUB_TOKEN from openmind by yourself and use it privatelly.
HUB_TOKEN=your_hub_token ./ci/functional_test.sh
```

2. å½“æ‚¨æ¨é€æˆ–æ›´æ–°PRï¼ˆPull Requestï¼‰åï¼Œç³»ç»Ÿå°†è‡ªåŠ¨è§¦å‘CIï¼ˆæŒç»­é›†æˆï¼‰æ„å»ºå’Œæµ‹è¯•æµç¨‹ã€‚è‹¥æ‰€æœ‰CIæ„å»ºå’Œæµ‹è¯•å‡é¡ºåˆ©é€šè¿‡ï¼Œ`ci-success`æ ‡è®°å°†è‡ªåŠ¨æ·»åŠ åˆ°æ‚¨çš„PRä¸­ã€‚ç„¶è€Œï¼Œè‹¥å‡ºç°CIæ•…éšœï¼Œæ‚¨å¯ä»¥ç‚¹å‡»CIæ—¥å¿—é“¾æ¥ä»¥è¯¦ç»†æŸ¥çœ‹å¤±è´¥åŸå› ï¼Œå¹¶åœ¨æœ¬åœ°è¿›è¡Œå¿…è¦çš„ä¿®å¤ã€‚ä¸€æ—¦æ‚¨å®Œæˆäº†ä¿®å¤å¹¶å¸Œæœ›é‡æ–°è¿è¡ŒCIä½œä¸šï¼Œåªéœ€åœ¨PRä¸­ç•™ä¸‹è¯„è®º`/recheck`å³å¯ã€‚

3. è¯¦ç»†è´¡çŒ®æŒ‡å—è¯·å‚è€ƒï¼š
    https://gitee.com/modelers/openmind/blob/dev/docs/zh/developer_tutorial/contribution.md

---

## ğŸ”’ å®‰å…¨å£°æ˜

ä¸ºä¿éšœä½¿ç”¨è¿‡ç¨‹å®‰å…¨ï¼Œæ¨èç”¨æˆ·å‚è€ƒ[ã€Šå®‰å…¨å£°æ˜ã€‹](./security_statement.md)äº†è§£ç›¸å…³å®‰å…¨ä¿¡æ¯ï¼Œè¿›è¡Œå¿…è¦çš„å®‰å…¨åŠ å›ºã€‚

---

## ğŸ“– è®¸å¯è¯
MulanPSL v2
openMind Libraryä½¿ç”¨æœ¨å…°å®½æ¾è®¸å¯è¯ç¬¬2ç‰ˆï¼ˆMulanPSL v2ï¼‰ã€‚è¯¦è§[LICENSE](http://license.coscl.org.cn/MulanPSL2)æ–‡ä»¶ã€‚
