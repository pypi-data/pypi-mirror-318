import{p as ue,aN as Te,g as de,t as x,n as l,s as Me,r as R,w as K,a as ae,aS as Ue,f as Ne,i as We,h as Ge,l as Qe,c as X,x as le,Q as Pe,y as C,z as T,A as a,X as ee,S as k,J as q,D as se,E as $e,a2 as je,F as me,aw as Ke,ax as fe,$ as B,B as J,aT as p,o as Ve,G as F,K as I,ae as Xe,az as Ye,aU as M,j as Je,ah as Ze,I as oe}from"./index-BZzpipaW.js";import{e as el}from"./eventbus-CGRXT3Tn.js";import{a as ce,c as Fe,R as qe,b as Ae,S as ll,e as Ce,g as tl,f as al,i as ve,w as L,j as nl,l as sl,d as De,n as il,o as ol,q as rl,v as O}from"./VListItem-C2OBJevj.js";import{b as U,V as ul}from"./VCardText-BoZHM4yp.js";import{_ as Ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as dl}from"./VSlider-BFgpmkL6.js";import{V as ml}from"./VTextField-BHlOQBvl.js";import{V as N,b as ne,a as fl}from"./VCard-Cy69XmTq.js";import{b as cl,a as ke}from"./VCheckboxBtn-CzqKCgg1.js";import{V as re,a as Oe}from"./VSwitch-DQl00Cwd.js";import{V as we}from"./VSpacer-B5caY5xC.js";import{V as Ee,a as Z}from"./VRow-DXVlNNuR.js";import{V as Re}from"./VContainer-S2w96F6j.js";import{V as Se,a as he}from"./VToolbar-zP5rPBtf.js";import{V as vl}from"./VDialog-Cp0-CJZR.js";import{V as pl}from"./VAlert-BKo8xbzV.js";import{V as gl}from"./VCheckbox-DGbOjerY.js";import"./VMenu-NpNzdaEd.js";import"./VList-BNjslZJ4.js";import"./VVirtualScroll-DC33eaBC.js";/* empty css              */const yl=ue({dotColor:String,fillDot:Boolean,hideDot:Boolean,icon:Te,iconColor:String,lineColor:String,...ce(),...Fe(),...qe(),...Ae()},"VTimelineDivider"),bl=de()({name:"VTimelineDivider",props:yl(),setup(t,g){let{slots:m}=g;const{sizeClasses:o,sizeStyles:s}=ll(t,"v-timeline-divider__dot"),{backgroundColorStyles:S,backgroundColorClasses:h}=Ce(x(t,"dotColor")),{roundedClasses:f}=tl(t,"v-timeline-divider__dot"),{elevationClasses:_}=al(t),{backgroundColorClasses:y,backgroundColorStyles:P}=Ce(x(t,"lineColor"));return ve(()=>l("div",{class:["v-timeline-divider",{"v-timeline-divider--fill-dot":t.fillDot},t.class],style:t.style},[l("div",{class:["v-timeline-divider__before",y.value],style:P.value},null),!t.hideDot&&l("div",{key:"dot",class:["v-timeline-divider__dot",_.value,f.value,o.value],style:s.value},[l("div",{class:["v-timeline-divider__inner-dot",h.value,f.value],style:S.value},[m.default?l(nl,{key:"icon-defaults",disabled:!t.icon,defaults:{VIcon:{color:t.iconColor,icon:t.icon,size:t.size}}},m.default):l(L,{key:"icon",color:t.iconColor,icon:t.icon,size:t.size},null)])]),l("div",{class:["v-timeline-divider__after",y.value],style:P.value},null)])),{}}}),He=ue({density:String,dotColor:String,fillDot:Boolean,hideDot:Boolean,hideOpposite:{type:Boolean,default:void 0},icon:Te,iconColor:String,lineInset:[Number,String],...ce(),...sl(),...Ae(),...Fe(),...qe(),...De()},"VTimelineItem"),Y=de()({name:"VTimelineItem",props:He(),setup(t,g){let{slots:m}=g;const{dimensionStyles:o}=il(t),s=Me(0),S=R();return K(S,h=>{var f;h&&(s.value=((f=h.$el.querySelector(".v-timeline-divider__dot"))==null?void 0:f.getBoundingClientRect().width)??0)},{flush:"post"}),ve(()=>{var h,f;return l("div",{class:["v-timeline-item",{"v-timeline-item--fill-dot":t.fillDot},t.class],style:[{"--v-timeline-dot-size":ae(s.value),"--v-timeline-line-inset":t.lineInset?`calc(var(--v-timeline-dot-size) / 2 + ${ae(t.lineInset)})`:ae(0)},t.style]},[l("div",{class:"v-timeline-item__body",style:o.value},[(h=m.default)==null?void 0:h.call(m)]),l(bl,{ref:S,hideDot:t.hideDot,icon:t.icon,iconColor:t.iconColor,size:t.size,elevation:t.elevation,dotColor:t.dotColor,fillDot:t.fillDot,rounded:t.rounded},{default:m.icon}),t.density!=="compact"&&l("div",{class:"v-timeline-item__opposite"},[!t.hideOpposite&&((f=m.opposite)==null?void 0:f.call(m))])])}),{}}}),_l=ue({align:{type:String,default:"center",validator:t=>["center","start"].includes(t)},direction:{type:String,default:"vertical",validator:t=>["vertical","horizontal"].includes(t)},justify:{type:String,default:"auto",validator:t=>["auto","center"].includes(t)},side:{type:String,validator:t=>t==null||["start","end"].includes(t)},lineThickness:{type:[String,Number],default:2},lineColor:String,truncateLine:{type:String,validator:t=>["start","end","both"].includes(t)},...Ue(He({lineInset:0}),["dotColor","fillDot","hideOpposite","iconColor","lineInset","size"]),...ce(),...ol(),...De(),...Ne()},"VTimeline"),Vl=de()({name:"VTimeline",props:_l(),setup(t,g){let{slots:m}=g;const{themeClasses:o}=We(t),{densityClasses:s}=rl(t),{rtlClasses:S}=Ge();Qe({VTimelineDivider:{lineColor:x(t,"lineColor")},VTimelineItem:{density:x(t,"density"),dotColor:x(t,"dotColor"),fillDot:x(t,"fillDot"),hideOpposite:x(t,"hideOpposite"),iconColor:x(t,"iconColor"),lineColor:x(t,"lineColor"),lineInset:x(t,"lineInset"),size:x(t,"size")}});const h=X(()=>{const _=t.side?t.side:t.density!=="default"?"end":null;return _&&`v-timeline--side-${_}`}),f=X(()=>{const _=["v-timeline--truncate-line-start","v-timeline--truncate-line-end"];switch(t.truncateLine){case"both":return _;case"start":return _[0];case"end":return _[1];default:return null}});return ve(()=>l(t.tag,{class:["v-timeline",`v-timeline--${t.direction}`,`v-timeline--align-${t.align}`,`v-timeline--justify-${t.justify}`,f.value,{"v-timeline--inset-line":!!t.lineInset},o.value,s.value,h.value,S.value,t.class],style:[{"--v-timeline-line-thickness":ae(t.lineThickness)},t.style]},m)),{}}}),Cl=le({__name:"DSPPipeline",props:{dsp:{},selected:{}},emits:["onSelect","onAddFilter","onMoveFilter","onDeleteFilter"],setup(t,{emit:g}){const m=Pe(),o=t,s=g,S=v=>o.selected===v?"primary":"secondary",h=v=>v==="input"||v==="output"?!1:!o.dsp.filters[v].enabled,f=v=>o.selected===v?"primary":m.global.current.value.dark?"grey-darken-3":"grey-lighten-3",_=v=>({"filter-selected":o.selected===v}),y=v=>{s("onSelect",v)},P=(v,c)=>{s("onMoveFilter",{index:v,direction:c})},z=v=>{s("onDeleteFilter",v)},G=function(v,c){const $=[{label:"settings.dsp.move_up",labelArgs:[],action:()=>{P(c,"up")},disabled:c===0,icon:"mdi-arrow-up"},{label:"settings.dsp.move_down",labelArgs:[],action:()=>{P(c,"down")},disabled:c===o.dsp.filters.length-1,icon:"mdi-arrow-down"},{label:"settings.dsp.delete_filter",labelArgs:[],action:()=>{z(c)},icon:"mdi-delete"}];el.emit("contextmenu",{items:$,posX:v.clientX,posY:v.clientY})};return(v,c)=>(C(),T(Vl,{density:"compact",side:"end"},{default:a(()=>[l(Y,{"dot-color":S("input"),size:"x-small",onClick:c[0]||(c[0]=$=>y("input"))},{default:a(()=>[l(O,{flat:"",rounded:"pill",color:f("input"),class:ee([_("input"),"dsp-pipeline-card"])},{default:a(()=>[l(U,{class:"px-3 py-1"},{default:a(()=>[k(q(v.$t("settings.dsp.input")),1)]),_:1})]),_:1},8,["color","class"])]),_:1},8,["dot-color"]),l(Y,{"hide-dot":!0,size:"x-small"}),(C(!0),se(me,null,$e(v.dsp.filters,($,w)=>(C(),T(Y,{key:w,"dot-color":S(w),size:"x-small","hide-dot":h(w),onClick:r=>y(w),onContextmenu:je(r=>G(r,w),["prevent"])},{default:a(()=>[l(O,{flat:"",rounded:"pill",color:f(w),class:ee([_(w),"dsp-pipeline-card"])},{default:a(()=>[l(U,{class:"px-3 py-1"},{default:a(()=>[k(q(v.$t(`settings.dsp.types.${$.type}`)),1)]),_:2},1024)]),_:2},1032,["color","class"])]),_:2},1032,["dot-color","hide-dot","onClick","onContextmenu"]))),128)),l(Y,{"dot-color":"secondary",size:"x-small","hide-dot":!0},{default:a(()=>[l(O,{outlined:"",rounded:"pill",class:"dsp-pipeline-card add-filter-btn",elevation:0,onClick:c[1]||(c[1]=$=>s("onAddFilter"))},{default:a(()=>[l(U,{class:"py-1 d-flex align-center"},{default:a(()=>[l(L,{size:"small",class:"mr-1"},{default:a(()=>c[3]||(c[3]=[k("mdi-plus")])),_:1}),k(" "+q(v.$t("settings.dsp.filter.add")),1)]),_:1})]),_:1})]),_:1}),l(Y,{"hide-dot":!0,size:"x-small"}),l(Y,{"dot-color":S("output"),size:"x-small",onClick:c[2]||(c[2]=$=>y("output"))},{default:a(()=>[l(O,{flat:"",rounded:"pill",color:f("output"),class:ee([_("output"),"dsp-pipeline-card"])},{default:a(()=>[l(U,{class:"px-3 py-1"},{default:a(()=>[k(q(v.$t("settings.dsp.output")),1)]),_:1})]),_:1},8,["color","class"])]),_:1},8,["dot-color"])]),_:1}))}}),kl=Ie(Cl,[["__scopeId","data-v-f292f100"]]),Sl={style:{"min-width":"40px"},class:"pl-2"},W=le({__name:"DSPSlider",props:Ke({type:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const g=t,m=fe(t,"modelValue"),o=R(!1),s=X(()=>g.type==="gain"?{min:-15,max:15,step:.1,label:B("settings.dsp.parameter.gain"),unit:"dB"}:g.type==="q"?{min:.1,max:20,step:.1,label:B("settings.dsp.parameter.q_factor"),unit:""}:g.type==="frequency"?{min:20,max:2e4,step:1,label:B("settings.dsp.parameter.frequency"),unit:"Hz"}:g.type),S=X({get:()=>o.value?m.value.toString():m.value>1e3?m.value.toFixed(0):m.value>100?m.value.toFixed(1):m.value.toFixed(2),set:h=>{m.value=Number(h)}});return(h,f)=>(C(),T(N,{flat:"",color:"transparent"},{default:a(()=>[l(U,{class:"d-flex align-center gap-4"},{default:a(()=>[l(dl,{modelValue:m.value,"onUpdate:modelValue":f[0]||(f[0]=_=>m.value=_),min:s.value.min,max:s.value.max,step:s.value.step,label:s.value.label,"hide-details":"",class:"flex-grow-1 pr-4",density:"compact",color:"primary"},null,8,["modelValue","min","max","step","label"]),l(ml,{modelValue:S.value,"onUpdate:modelValue":f[1]||(f[1]=_=>S.value=_),type:"number","hide-details":"",density:"compact",style:{"max-width":"100px"},onFocus:f[2]||(f[2]=_=>o.value=!0),onBlur:f[3]||(f[3]=_=>o.value=!1)},null,8,["modelValue"]),J("span",Sl,q(s.value.unit),1)]),_:1})]),_:1}))}}),hl={class:"d-flex justify-end"},Tl={class:"d-flex align-center mb-4"},Pl=le({__name:"DSPParametricEQ",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(t){const g={PK:p.PEAK,PEQ:p.PEAK,HP:p.HIGH_PASS,HPQ:p.HIGH_PASS,LP:p.LOW_PASS,LPQ:p.LOW_PASS,LS:p.LOW_SHELF,HS:p.HIGH_SHELF,NO:p.NOTCH},m={[p.PEAK]:"PK",[p.HIGH_PASS]:"HP",[p.LOW_PASS]:"LP",[p.LOW_SHELF]:"LS",[p.HIGH_SHELF]:"HS",[p.NOTCH]:"NO"},o=i=>{const e=i.split(`
`),u=[];for(const b of e)if(b.startsWith("Filter")){const V=b.match(/Filter(?:\s+\d+)?:\s+(ON|OFF)\s+(\w+)\s+(?:Fc\s+)?(\d+\.?\d*)\s*(?:Hz)?\s+(?:Gain\s+)?(-?\d+\.?\d*)\s+dB\s+(?:(?:Q\s+)?(\d+\.?\d*)|(?:BW\s+Oct\s+)(\d+\.?\d*))/);if(V){const[D,Q,j,A,H,ge,ye]=V;j!=="None"&&u.push({frequency:parseFloat(A),gain:parseFloat(H),q:parseFloat(ge),type:g[j]||p.PEAK,enabled:Q==="ON"})}}y.value.bands=u,n.value=0},s=i=>{const e=i.target;if(e.files&&e.files[0]){const u=e.files[0],b=new FileReader;b.onload=V=>{var D;(D=V.target)!=null&&D.result&&o(V.target.result)},b.readAsText(u)}},S=R(null),h=()=>{var i;(i=S.value)==null||i.click()},f=()=>{let i=`Preamp: 0 dB
`;y.value.bands.forEach(V=>{const D=m[V.type];i+=`Filter: ${V.enabled?"ON":"OFF"} ${D} Fc ${V.frequency.toFixed(1)} Hz Gain ${V.gain.toFixed(2)} dB Q ${V.q.toFixed(3)}
`});const e=new Blob([i],{type:"text/plain"}),u=URL.createObjectURL(e),b=document.createElement("a");b.href=u,b.download=`music_assistant_eq_settings_${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(u)},_=Pe(),y=fe(t,"modelValue"),P=R(null),z=R(null),G=Object.values(p).map(i=>({title:B(`settings.dsp.parametric_eq.filter_types.${i}`),value:i})),v=i=>![p.HIGH_PASS,p.LOW_PASS,p.NOTCH].includes(i),c=R({width:0,height:0,min_gain:-20,max_gain:20,min_freq:20,max_freq:2e4,padding_lr:40,padding_tb:20}),$=()=>{if(!P.value||!z.value)return;const i=_.global.current.value.dark,e=P.value.getContext("2d");if(!e)return;P.value.width=z.value.clientWidth*2,P.value.height=z.value.clientHeight*2,c.value.width=P.value.width/2,c.value.height=P.value.height/2,e.scale(2,2),e.clearRect(0,0,P.value.width,P.value.height),ze(e,c.value);const u=e.canvas.width/2;e.canvas.height/2;const b=new Float32Array(u);y.value.bands.forEach((V,D)=>{if(V.enabled){let Q=`hsla(${D*360/y.value.bands.length}, 60%, ${i?70:50}%, 0.5)`;e.beginPath(),D===n.value?(e.lineWidth=5,Q=`hsla(${D*360/y.value.bands.length}, 70%, ${i?70:60}%, 1)`):e.lineWidth=2,e.strokeStyle=Q;const j=new Float32Array(u);for(let E=0;E<u;E++)j[E]=Be(E,c.value);const A=new Float32Array(u),H=new Float32Array(u);w(r,V).getFrequencyResponse(j,A,H);for(let E=c.value.padding_lr;E<u-c.value.padding_lr;E++){const be=20*Math.log10(A[E]);b[E]+=be;const _e=te(be,c.value);E===0?e.moveTo(E,_e):e.lineTo(E,_e)}e.stroke();const ye=pe(V.frequency,c.value),Le=te(V.gain,c.value);e.beginPath(),e.fillStyle=Q,e.arc(ye,Le,6,0,2*Math.PI),e.fill()}}),e.lineWidth=2,i?e.strokeStyle="#fff":e.strokeStyle="#000",e.beginPath();for(let V=c.value.padding_lr;V<u-c.value.padding_lr;V++){const D=te(b[V],c.value);V===0?e.moveTo(V,D):e.lineTo(V,D)}e.stroke()},w=(i,e)=>{const u=i.createBiquadFilter();switch(e.type){case p.HIGH_PASS:u.type="highpass";break;case p.LOW_PASS:u.type="lowpass";break;case p.HIGH_SHELF:u.type="highshelf";break;case p.LOW_SHELF:u.type="lowshelf";break;case p.NOTCH:u.type="notch";break;case p.PEAK:u.type="peaking";break}return u.frequency.value=e.frequency,u.Q.value=e.q,u.gain.value=e.gain,u},r=new AudioContext;X(()=>y.value.bands.map(i=>w(r,i)));const n=R(0),d=X(()=>y.value.bands[n.value]),ie=i=>{y.value.bands.splice(i,1),n.value>=y.value.bands.length&&(n.value=y.value.bands.length-1)},xe=()=>{const i=y.value.bands.length;y.value.bands.push({frequency:1e3,q:1,gain:0,type:p.PEAK,enabled:!0}),n.value=i};K(()=>y.value.bands,$,{deep:!0}),K(()=>n.value,$),K(()=>_.global.current.value.dark,$),Ve(()=>{$(),window.addEventListener("resize",$)});const pe=(i,e)=>{const u=Math.log2(i/e.min_freq),b=Math.log2(e.max_freq/e.min_freq);return u/b*(e.width-e.padding_lr*2)+e.padding_lr},Be=(i,e)=>{const u=Math.log2(e.max_freq/e.min_freq),b=e.min_freq*Math.pow(2,(i-e.padding_lr)/(e.width-e.padding_lr*2)*u);return Math.min(Math.max(b,e.min_freq),e.max_freq)},te=(i,e)=>e.height/2-i*(e.height-2*e.padding_tb)/(2*Math.max(Math.abs(e.min_gain),Math.abs(e.max_gain))),ze=(i,e)=>{const u=i.canvas.width/2,b=i.canvas.height/2;_.global.current.value.dark?(i.fillStyle="#eee",i.strokeStyle="#eee"):(i.fillStyle="#222",i.strokeStyle="#666"),i.lineWidth=1,[20,50,100,200,500,1e3,2e3,5e3,1e4,2e4].forEach(A=>{const H=pe(A,e);i.beginPath(),i.moveTo(H,e.padding_tb),i.lineTo(H,b-e.padding_tb),i.stroke(),i.font="10px Arial",i.textAlign="center",i.fillText(A>=1e3?`${A/1e3}k`:A.toString(),H,b-5)});const Q=e.max_gain-e.min_gain,j=Math.ceil(Q/(e.height/30));for(let A=e.min_gain;A<=e.max_gain;A+=j){const H=te(A,e);i.beginPath(),i.moveTo(e.padding_lr,H),i.lineTo(u-e.padding_lr,H),i.stroke(),i.font="10px Arial",i.textAlign="right",i.fillText(`${A}dB`,e.padding_lr-3,H+3)}};return Ve(()=>{const i=new ResizeObserver(()=>{$()});return z.value&&i.observe(z.value),()=>{i.disconnect()}}),(i,e)=>(C(),T(Re,{class:"pa-2"},{default:a(()=>[J("div",hl,[l(O,{variant:"outlined",class:"mr-2",onClick:h},{default:a(()=>[l(L,{start:""},{default:a(()=>e[7]||(e[7]=[k("mdi-file-import")])),_:1}),k(" "+q(F(B)("settings.dsp.parametric_eq.import_apo")),1)]),_:1}),l(O,{variant:"outlined",class:"mr-2",onClick:f},{default:a(()=>[l(L,{start:""},{default:a(()=>e[8]||(e[8]=[k("mdi-file-export")])),_:1}),k(" "+q(F(B)("settings.dsp.parametric_eq.export_apo")),1)]),_:1}),J("input",{ref_key:"fileInputRef",ref:S,type:"file",accept:".txt",class:"d-none",onChange:s},null,544)]),l(N,{elevation:"0",color:"transparent"},{default:a(()=>[J("div",{ref_key:"graphContainer",ref:z,class:"graph-container"},[J("canvas",{ref_key:"canvas",ref:P,class:"frequency-graph"},null,512)],512)]),_:1}),l(N,{elevation:"0",color:"transparent",class:"border-t border-b rounded-0"},{default:a(()=>[l(U,{class:"pa-0"},{default:a(()=>[l(cl,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=u=>n.value=u),class:"mb-0 pa-2",mandatory:"","selected-class":"primary"},{default:a(()=>[(C(!0),se(me,null,$e(y.value.bands,(u,b)=>(C(),T(ke,{key:b,value:b,class:ee({"opacity-50":!u.enabled}),filter:"",variant:"elevated"},{default:a(()=>[k(q(F(B)("settings.dsp.parametric_eq.band",{index:b+1})),1)]),_:2},1032,["value","class"]))),128)),l(ke,{variant:"outlined",onClick:xe},{default:a(()=>[l(L,{icon:"mdi-plus",start:""}),k(" "+q(F(B)("settings.dsp.parametric_eq.add_band")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),d.value?(C(),T(N,{key:0,elevation:"0",color:"transparent"},{default:a(()=>[l(U,null,{default:a(()=>[J("div",Tl,[l(re,{modelValue:d.value.enabled,"onUpdate:modelValue":e[1]||(e[1]=u=>d.value.enabled=u),label:F(B)("settings.dsp.parametric_eq.enable_band"),density:"comfortable","hide-details":"",color:"primary"},null,8,["modelValue","label"]),l(we),l(O,{color:"error",variant:"tonal",onClick:e[2]||(e[2]=u=>ie(n.value))},{default:a(()=>[l(L,null,{default:a(()=>e[9]||(e[9]=[k("mdi-delete")])),_:1}),k(" "+q(F(B)("settings.dsp.parametric_eq.delete_band")),1)]),_:1})]),l(Ee,{dense:""},{default:a(()=>[l(Z,{cols:"12"},{default:a(()=>[l(Oe,{modelValue:d.value.type,"onUpdate:modelValue":e[3]||(e[3]=u=>d.value.type=u),items:F(G),label:F(B)("settings.dsp.parametric_eq.filter_type"),variant:"outlined",density:"comfortable"},null,8,["modelValue","items","label"])]),_:1}),l(Z,{cols:"12"},{default:a(()=>[l(W,{modelValue:d.value.frequency,"onUpdate:modelValue":e[4]||(e[4]=u=>d.value.frequency=u),type:"frequency"},null,8,["modelValue"])]),_:1}),v(d.value.type)?(C(),T(Z,{key:0,cols:"12"},{default:a(()=>[l(W,{modelValue:d.value.gain,"onUpdate:modelValue":e[5]||(e[5]=u=>d.value.gain=u),type:"gain"},null,8,["modelValue"])]),_:1})):I("",!0),l(Z,{cols:"12"},{default:a(()=>[l(W,{modelValue:d.value.q,"onUpdate:modelValue":e[6]||(e[6]=u=>d.value.q=u),type:"q"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})):I("",!0)]),_:1}))}}),$l=Ie(Pl,[["__scopeId","data-v-c755c3d6"]]),Fl=le({__name:"DSPToneControl",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(t){const g=fe(t,"modelValue");return(m,o)=>(C(),se(me,null,[l(ne,null,{default:a(()=>[l(W,{modelValue:g.value.bass_level,"onUpdate:modelValue":o[0]||(o[0]=s=>g.value.bass_level=s),type:{min:-10,max:10,step:.1,label:m.$t("settings.dsp.tone_control.bass_level"),unit:"dB"}},null,8,["modelValue","type"])]),_:1}),l(ne,null,{default:a(()=>[l(W,{modelValue:g.value.mid_level,"onUpdate:modelValue":o[1]||(o[1]=s=>g.value.mid_level=s),type:{min:-10,max:10,step:.1,label:m.$t("settings.dsp.tone_control.mid_level"),unit:"dB"}},null,8,["modelValue","type"])]),_:1}),l(ne,null,{default:a(()=>[l(W,{modelValue:g.value.treble_level,"onUpdate:modelValue":o[2]||(o[2]=s=>g.value.treble_level=s),type:{min:-10,max:10,step:.1,label:m.$t("settings.dsp.tone_control.treble_level"),unit:"dB"}},null,8,["modelValue","type"])]),_:1})],64))}}),ql={key:0},Yl=le({__name:"EditPlayerDsp",props:{playerId:{}},setup(t){const{t:g}=Xe();Ye();const m=t,o=R(),s=R(null),S=R(!1),h=R(M.PARAMETRIC_EQ);R(window.innerWidth);const{mobile:f}=Je(),_=Object.values(M).map(r=>({value:r,title:g(`settings.dsp.types.${r}`)})),y=r=>{s.value=r},P=r=>{var n;return g(r==="input"?"settings.dsp.input":r==="output"?"settings.dsp.output":`settings.dsp.types.${(n=o.value)==null?void 0:n.filters[r].type}`)},z=()=>{if(!o.value)return;let r;switch(h.value){case M.PARAMETRIC_EQ:r={enabled:!0,type:M.PARAMETRIC_EQ,bands:[]};break;case M.TONE_CONTROL:r={enabled:!0,type:M.TONE_CONTROL,bass_level:0,mid_level:0,treble_level:0};break;default:return}o.value.filters.push(r),S.value=!1,y(o.value.filters.length-1)},G=(r,n)=>{if(!o.value)return;const d=n==="up"?r-1:r+1;if(d<0||d>=o.value.filters.length)return;const[ie]=o.value.filters.splice(r,1);o.value.filters.splice(d,0,ie),s.value===r?s.value=d:s.value===d&&(s.value=r)},v=r=>{var n;s.value===r&&(s.value="input"),(n=o.value)==null||n.filters.splice(r,1)};K(f,r=>{!r&&s.value===null&&y("input")},{immediate:!0});const c=X(()=>Ze(oe.players[m.playerId],27));K(()=>m.playerId,async r=>{r&&(o.value=await oe.getDSPConfig(r))},{immediate:!0});let $=null;const w=r=>{$&&clearTimeout($),$=setTimeout(async()=>{m.playerId&&await oe.saveDSPConfig(m.playerId,r)},2e3)};return K(o,(r,n)=>{r!==null&&n&&w(n)},{deep:!0}),(r,n)=>o.value?(C(),se("section",ql,[l(Se,{color:"transparent",class:"border-b"},{default:a(()=>[l(re,{modelValue:o.value.enabled,"onUpdate:modelValue":n[0]||(n[0]=d=>o.value.enabled=d),"hide-details":"",color:"primary",class:"pl-4"},null,8,["modelValue"]),l(he,null,{default:a(()=>[k(q(r.$t("settings.dsp.configure_on",{name:c.value})),1)]),_:1})]),_:1}),l(Re,{class:"pa-4"},{default:a(()=>[o.value.enabled?I("",!0):(C(),T(pl,{key:0,type:"info",class:"mt-4",color:"transparent"},{default:a(()=>[k(q(r.$t("settings.dsp.disabled_message")),1)]),_:1})),l(Ee,{class:ee([{"justify-center":F(f)},"flex-nowrap"])},{default:a(()=>[!F(f)||s.value===null?(C(),T(Z,{key:0,class:ee(["flex-grow-0 flex-shrink-0",{"border-e pr-4":!F(f)}]),"align-self":"start"},{default:a(()=>[l(kl,{dsp:o.value,selected:s.value,onOnSelect:y,onOnAddFilter:n[1]||(n[1]=d=>S.value=!0),onOnMoveFilter:n[2]||(n[2]=d=>G(d.index,d.direction)),onOnDeleteFilter:v},null,8,["dsp","selected"])]),_:1},8,["class"])):I("",!0),s.value!=null?(C(),T(Z,{key:1,style:{"min-width":"0"}},{default:a(()=>[l(Se,{density:"compact",color:r.$vuetify.theme.current.dark?"surface":"surface-light",class:"border-b"},{default:a(()=>[F(f)?(C(),T(O,{key:0,class:"hidden-xs-only",icon:"",onClick:n[3]||(n[3]=d=>s.value=null)},{default:a(()=>[l(L,null,{default:a(()=>n[16]||(n[16]=[k("mdi-arrow-left")])),_:1})]),_:1})):I("",!0),l(he,null,{default:a(()=>[k(q(P(s.value)),1)]),_:1}),typeof s.value=="number"&&!F(f)&&s.value>0?(C(),T(O,{key:1,icon:"",onClick:n[4]||(n[4]=d=>G(s.value,"up"))},{default:a(()=>[l(L,null,{default:a(()=>n[17]||(n[17]=[k("mdi-arrow-up")])),_:1})]),_:1})):I("",!0),typeof s.value=="number"&&!F(f)&&s.value<o.value.filters.length-1?(C(),T(O,{key:2,icon:"",onClick:n[5]||(n[5]=d=>G(s.value,"down"))},{default:a(()=>[l(L,null,{default:a(()=>n[18]||(n[18]=[k("mdi-arrow-down")])),_:1})]),_:1})):I("",!0),typeof s.value=="number"?(C(),T(re,{key:3,modelValue:o.value.filters[s.value].enabled,"onUpdate:modelValue":n[6]||(n[6]=d=>o.value.filters[s.value].enabled=d),"hide-details":"",color:"primary",class:"mr-4"},null,8,["modelValue"])):I("",!0),typeof s.value=="number"?(C(),T(O,{key:4,icon:"",onClick:n[7]||(n[7]=d=>v(s.value))},{default:a(()=>[l(L,null,{default:a(()=>n[19]||(n[19]=[k("mdi-delete")])),_:1})]),_:1})):I("",!0)]),_:1},8,["color"]),s.value==="input"?(C(),T(N,{key:0,flat:"",color:r.$vuetify.theme.current.dark?"surface":"surface-light"},{default:a(()=>[l(W,{modelValue:o.value.input_gain,"onUpdate:modelValue":n[8]||(n[8]=d=>o.value.input_gain=d),type:"gain"},null,8,["modelValue"])]),_:1},8,["color"])):s.value==="output"?(C(),T(N,{key:1,flat:"",color:r.$vuetify.theme.current.dark?"surface":"surface-light"},{default:a(()=>[l(ne,null,{default:a(()=>[l(W,{modelValue:o.value.output_gain,"onUpdate:modelValue":n[9]||(n[9]=d=>o.value.output_gain=d),type:"gain"},null,8,["modelValue"]),l(gl,{modelValue:o.value.output_limiter,"onUpdate:modelValue":n[10]||(n[10]=d=>o.value.output_limiter=d),label:r.$t("settings.dsp.enable_output_limiter")},null,8,["modelValue","label"])]),_:1})]),_:1},8,["color"])):(C(),T(N,{key:2,flat:"",color:r.$vuetify.theme.current.dark?"surface":"surface-light"},{default:a(()=>[o.value.filters[s.value].type===F(M).PARAMETRIC_EQ?(C(),T($l,{key:0,modelValue:o.value.filters[s.value],"onUpdate:modelValue":n[11]||(n[11]=d=>o.value.filters[s.value]=d)},null,8,["modelValue"])):I("",!0),o.value.filters[s.value].type===F(M).TONE_CONTROL?(C(),T(Fl,{key:1,modelValue:o.value.filters[s.value],"onUpdate:modelValue":n[12]||(n[12]=d=>o.value.filters[s.value]=d)},null,8,["modelValue"])):I("",!0)]),_:1},8,["color"]))]),_:1})):I("",!0)]),_:1},8,["class"])]),_:1}),l(vl,{modelValue:S.value,"onUpdate:modelValue":n[15]||(n[15]=d=>S.value=d),"max-width":"300"},{default:a(()=>[l(N,null,{default:a(()=>[l(ul,null,{default:a(()=>[k(q(r.$t("settings.dsp.filter.add")),1)]),_:1}),l(U,null,{default:a(()=>[l(Oe,{modelValue:h.value,"onUpdate:modelValue":n[13]||(n[13]=d=>h.value=d),items:F(_),label:r.$t("settings.dsp.filter.type")},null,8,["modelValue","items","label"])]),_:1}),l(fl,null,{default:a(()=>[l(we),l(O,{onClick:n[14]||(n[14]=d=>S.value=!1)},{default:a(()=>[k(q(r.$t("cancel")),1)]),_:1}),l(O,{color:"primary",onClick:z},{default:a(()=>[k(q(r.$t("settings.dsp.filter.add")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])):I("",!0)}});export{Yl as default};
