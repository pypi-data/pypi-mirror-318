import{x as V,r as s,w,o as I,H as t,b as $,y as i,D as f,n as m,A as p,I as B,G as g,F as k,E as S,z as y,K as C}from"./index-B_7MB9cq.js";import{I as F}from"./ItemsListing-7ie9GkJx.js";import{C as L}from"./Container-D28yS2Qt.js";import{T as E}from"./Toolbar-DU0qKW3Y.js";import{V as _}from"./VTextField-BthjCt5r.js";import{V as R,a as x}from"./VRow-BlX9_Kgs.js";import"./ListviewItem-gtjmXeUm.js";import"./ItemContextMenu.vue_vue_type_style_index_0_scoped_f3b3d521_lang-B_xp9W-c.js";import"./ProviderIcon.vue_vue_type_script_setup_true_lang-iG77pVu5.js";import"./VListItem-DQbKCpF1.js";import"./VCheckboxBtn-DIsTFzKM.js";import"./VList-BrU35shR.js";import"./VCardText-VTK4ABkI.js";import"./VCard-B_pP5ULR.js";import"./VMenu-BGsGFkJ9.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./eventbus-CGRXT3Tn.js";import"./ListItem-H6Rk1d-8.js";import"./VCheckbox-_z11ltY6.js";import"./VSpacer-CXtBFdCv.js";/* empty css              */import"./PanelviewItemCompact-CAHU4dZH.js";import"./VInfiniteScroll-DxXdMoC7.js";import"./layout-Dg0TAyF_.js";import"./VVirtualScroll-BTfTlnJH.js";import"./VAlert-BRzJbztO.js";import"./VContainer-DP5sflss.js";import"./VToolbar-CBkJDPkH.js";const me=V({__name:"Search",setup(H){const d=s(),n=s(!1),a=s(),h=s(!1),v=s();w(()=>t.globalSearchTerm,()=>{clearTimeout(v.value),v.value=setTimeout(()=>{T()},200)},{immediate:!0});const T=async function(){h.value=!0,localStorage.setItem("globalsearch",t.globalSearchTerm||""),t.globalSearchTerm?a.value=await B.search(t.globalSearchTerm):a.value=void 0,h.value=!1,d.value=t.globalSearchTerm},c=function(e){if(!a.value)return[];if(e=="artists")return a.value.artists;if(e=="albums")return a.value.albums;if(e=="tracks")return a.value.tracks;if(e=="playlists")return a.value.playlists;if(e=="radio")return a.value.radio;if(e=="topresult"){const l=[];for(const o of[a.value.tracks,a.value.artists,a.value.albums,a.value.playlists,a.value.radio]){const r=[];for(const u of o)r.includes(u.provider)||(l.push(u),r.push(u.provider))}return l}return[]};I(()=>{if(!t.globalSearchTerm){const e=localStorage.getItem("globalsearch");e&&e!=="null"&&(t.globalSearchTerm=e)}});const b=function(e){!n.value&&e.key=="Backspace"&&t.globalSearchTerm?t.globalSearchTerm=t.globalSearchTerm.slice(0,-1):!n.value&&e.key.length==1&&(t.globalSearchTerm+=e.key)};return document.addEventListener("keyup",b),$(()=>{document.removeEventListener("keyup",b)}),(e,l)=>(i(),f("section",null,[m(E,{icon:"mdi-magnify",title:e.$t("search")},null,8,["title"]),m(L,{variant:"default"},{default:p(()=>[m(_,{id:"searchInput",modelValue:g(t).globalSearchTerm,"onUpdate:modelValue":l[0]||(l[0]=o=>g(t).globalSearchTerm=o),clearable:"","prepend-inner-icon":"mdi-magnify",label:e.$t("type_to_search"),"hide-details":"",variant:"outlined",onFocus:l[1]||(l[1]=o=>n.value=!0),onBlur:l[2]||(l[2]=o=>n.value=!1)},null,8,["modelValue","label"]),(i(),f(k,null,S([["topresult","tracks"],["artists","albums"],["playlists","radio"]],o=>m(R,{key:o[0]+o[1]},{default:p(()=>[(i(!0),f(k,null,S(o.filter(r=>c(r).length),r=>(i(),y(x,{key:r},{default:p(()=>[c(r).length?(i(),y(F,{key:0,itemtype:`search.${r}`,path:`search.${d.value}`,"show-provider":!0,"show-favorites-only-filter":!1,"show-select-button":!1,"show-refresh-button":!1,"load-items":async u=>c(r),title:e.$t(r),"allow-key-hooks":!1,"show-search-button":!1,limit:8,"infinite-scroll":!1,"sort-keys":[]},null,8,["itemtype","path","load-items","title"])):C("",!0)]),_:2},1024))),128))]),_:2},1024)),64))]),_:1})]))}});export{me as default};
