"use strict";(self["webpackChunkSimple_Web_based_Interface_for_Scanner"]=self["webpackChunkSimple_Web_based_Interface_for_Scanner"]||[]).push([[3],{5003:(e,i,t)=>{t.r(i),t.d(i,{default:()=>v});var n=t(3673),o=t(2323);const s={key:0,class:"row rounded-borders"},l={key:0,style:{width:"128px",height:"128px",border:"1px solid #eee","vertical-align":"middle","justify-items":"center","align-items":"center",display:"flex","flex-direction":"column","justify-content":"center","align-content":"center"}},r=["href"],a={class:"row"};function c(e,i,t,c,f,d){const p=(0,n.up)("q-input"),m=(0,n.up)("q-btn"),h=(0,n.up)("q-item-section"),u=(0,n.up)("q-icon"),g=(0,n.up)("q-img"),_=(0,n.up)("q-item"),w=(0,n.up)("q-list"),b=(0,n.up)("q-page");return(0,n.wg)(),(0,n.j4)(b,{class:"col"},{default:(0,n.w5)((()=>[(0,n.Wm)(w,{class:"shadow-2 rounded-borders q-mx-lg q-my-lg",style:{width:"96%"}},{default:(0,n.w5)((()=>[this.pdflist.length>0?((0,n.wg)(),(0,n.iD)("div",s,[(0,n.Wm)(p,{outlined:"",modelValue:e.pdffilename,"onUpdate:modelValue":i[0]||(i[0]=i=>e.pdffilename=i),label:"Filename (optional)",class:"q-ma-sm"},null,8,["modelValue"]),(0,n.Wm)(m,{label:"Create PDF",icon:"picture_as_pdf",onClick:e.createPdf,class:"q-ma-sm",color:"red"},null,8,["onClick"])])):(0,n.kq)("",!0),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.items,(i=>((0,n.wg)(),(0,n.j4)(_,{key:i,style:{"border-bottom":"1px solid #eee"}},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{thumbnail:""},{default:(0,n.w5)((()=>[i.onpdflist||!i.filename.endsWith("png")&&!i.filename.endsWith("jpg")?i.onpdflist?((0,n.wg)(),(0,n.j4)(m,{key:1,onClick:t=>e.removeFromPdfList(i.filename),label:e.getPdfListIndex(i.filename),size:"xs",outline:"",rounded:"",style:{width:"10px","margin-left":"5px"}},null,8,["onClick","label"])):((0,n.wg)(),(0,n.j4)(m,{key:2,size:"xs",flat:"",rounded:"",style:{width:"10px","margin-left":"5px"},disabled:""})):((0,n.wg)(),(0,n.j4)(m,{key:0,onClick:t=>e.addToPdfList(i.filename),icon:"picture_as_pdf",size:"xs",outline:"",rounded:"",style:{width:"10px","margin-left":"5px"}},null,8,["onClick"]))])),_:2},1024),(0,n.Wm)(h,{thumbnail:""},{default:(0,n.w5)((()=>[i.filename.endsWith("pdf")?((0,n.wg)(),(0,n.iD)("div",l,[(0,n.Wm)(u,{name:"picture_as_pdf",class:"text-center",fit:"contain",style:{width:"128px","max-height":"128px"},size:"64px",color:"red"})])):((0,n.wg)(),(0,n.j4)(g,{key:1,class:"text-center",fit:"contain",style:{width:"128px","max-height":"128px",height:"128px",border:"1px solid #eee"},"img-style":{"min-width":"100%","min-height":"100%","object-fit":"cover"},src:`${i.thumbnail}`,"spinner-color":"black"},null,8,["src"]))])),_:2},1024),(0,n.Wm)(h,{style:{"overflow-wrap":"break-word",hyphens:"auto","word-break":"break-all"}},{default:(0,n.w5)((()=>[(0,n._)("a",{href:i.src,style:{"font-size":"0.9rem"}},(0,o.zw)(i.filename),9,r)])),_:2},1024),(0,n.Wm)(h,{avatar:""},{default:(0,n.w5)((()=>[(0,n._)("div",a,[(0,n.Wm)(m,{class:"q-mr-sm",color:"blue",label:"",icon:"print",size:"sm",onClick:t=>e.printImage(i.filename)},null,8,["onClick"]),(0,n.Wm)(m,{color:"red",label:"",icon:"delete",size:"sm",onClick:t=>e.removeImage(i.filename)},null,8,["onClick"])])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})}t(2100);const f=(0,n.aZ)({name:"PageScanList",data:function(){return{files:[],config:void 0,pdflist:[],pdffilename:""}},created:function(){},computed:{items:function(){return this.files.map((e=>({filename:e.filename,src:`http://${this.config.api_url}:${this.config.api_port}${this.config.scans_url}/${e.filename}`,thumbnail:`http://${this.config.api_url}:${this.config.api_port}${this.config.scans_url}/${e.thumbnail}`,type:this.getFileType(e.filename),onpdflist:this.pdflist.includes(e.filename)})))}},mounted(){this.getScanList()},methods:{getScanList:function(){this.getJSON("config","config.json").then((e=>{this.config=e,this.$axios.get(`http://${this.config.api_url}:${this.config.api_port}/scans`).then((e=>{200==(null===e||void 0===e?void 0:e.status)?this.files=e.data.filenames:(this.$q.notify({color:"negative",message:"Error loading scans",icon:"report_problem"}),console.error(e))})).catch((e=>{this.$q.notify({color:"negative",message:"Error loading scans",icon:"report_problem"}),console.error(e)}))}))},addToPdfList:function(e){this.pdflist.push(e)},removeFromPdfList:function(e){this.pdflist=this.pdflist.filter((i=>i!=e))},getPdfListIndex:function(e){return this.pdflist.indexOf(e)+1},createPdf:function(){return new Promise(((e,i)=>{this.$axios.post(`http://${this.config.api_url}:${this.config.api_port}/makepdf`,{target:this.pdffilename,filenames:this.pdflist}).then((e=>{200==(null===e||void 0===e?void 0:e.status)?(this.$q.notify({color:"positive",message:"PDF created",icon:"done"}),this.pdflist=[],this.pdffilename="",this.getScanList(),window.open(`http://${this.config.api_url}:${this.config.api_port}/files/${e.data.filename}`,"_blank")):(this.$q.notify({color:"negative",message:'Error creating PDF. Make sure you have "convert" tool installed on server.',icon:"report_problem"}),console.error(e))}))}))},getJSON:function(e,i){return new Promise(((t,n)=>{this.$axios.get(i).then((i=>{let n=i.data;localStorage.setItem(e,JSON.stringify(n)),t(n)})).catch((e=>{this.$q.notify({color:"negative",message:`Error loading ${i}`,icon:"report_problem"}),console.error(e),n(e)}))}))},getFileType:function(e){let i=e.split(".").pop().toLowerCase();return["jpg","jpeg","png"].includes(i)?"img":"other"},removeImage:function(e){this.$axios.delete(`http://${this.config.api_url}:${this.config.api_port}/scans/${e}`).then((i=>{200==(null===i||void 0===i?void 0:i.status)?this.files=this.files.filter((i=>i.filename!=e)):(this.$q.notify({color:"negative",message:"Error deleting image",icon:"report_problem"}),console.error(i))})).catch((e=>{this.$q.notify({color:"negative",message:"Error deleting image",icon:"report_problem"}),console.error(e)}))},printImage:function(e){this.$router.push({path:"/print",query:{filename:e}})}}});var d=t(4260),p=t(4379),m=t(7011),h=t(4842),u=t(4607),g=t(3414),_=t(2035),w=t(4554),b=t(4027),y=t(7518),x=t.n(y);const $=(0,d.Z)(f,[["render",c]]),v=$;x()(f,"components",{QPage:p.Z,QList:m.Z,QInput:h.Z,QBtn:u.Z,QItem:g.Z,QItemSection:_.Z,QIcon:w.Z,QImg:b.Z})}}]);