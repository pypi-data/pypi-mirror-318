function(a,b){if(typeof define==='function'&&define.amd)define('leafletFullScreen',['leaflet'],b);else typeof module==='object'&&module.exports?module.exports=b(require('leaflet')):b(a.L)}(typeof self!=='undefined'?self:this,A=>{'use strict';if(typeof document==='undefined'){console.warn('"window.document" is undefined; leaflet.fullscreen requires this object to access the DOM');return!1}var _=(()=>{const B=[['requestFullscreen','exitFullscreen','fullscreenElement','fullscreenEnabled','fullscreenchange','fullscreenerror'],['webkitRequestFullscreen','webkitExitFullscreen','webkitFullscreenElement','webkitFullscreenEnabled','webkitfullscreenchange','webkitfullscreenerror']],C=B[0],_c={};for(const _a of B)if(_a[1] in document){for(let i=0;i<_a.length;i++)_c[C[i]]=_a[i];return _c}return!1})(),c={change:_.fullscreenchange,error:_.fullscreenerror},d={request(D,_b){return new Promise((_A,_B)=>{const _C=function(){this.off('change',_C);_A()}.bind(this);this.on('change',_C);D=D||document.documentElement;const _d=D[_.requestFullscreen](_b);_d instanceof Promise&&_d.then(_C).catch(_B)})},exit(){return new Promise((e,E)=>{if(!this.isFullscreen){e();return}const aA=function(){this.off('change',aA);e()}.bind(this);this.on('change',aA);const _D=document[_.exitFullscreen]();_D instanceof Promise&&_D.then(aA).catch(E)})},on(aB,aC){const aD=c[aB];aD&&document.addEventListener(aD,aC,!1)},off(aE,aF){const aG=c[aE];aG&&document.removeEventListener(aG,aF,!1)},nativeAPI:_};Object.defineProperties(d,{isFullscreen:{get(){return!!document[_.fullscreenElement]}},isEnabled:{enumerable:!0,get(){return!!document[_.fullscreenEnabled]}}});A.Control.FullScreen=A.Control.extend({options:{position:'topleft',title:'Full Screen',titleCancel:'Exit Full Screen',forceSeparateButton:!1,forcePseudoFullscreen:!1,fullscreenElement:!1},_screenfull:d,onAdd(aH){let aI='leaflet-control-zoom-fullscreen';let aJ;let aK='';aH.zoomControl&&!this.options.forceSeparateButton?aJ=aH.zoomControl._container:aJ=A.DomUtil.create('div','leaflet-bar');this.options.content?aK=this.options.content:aI+=' fullscreen-icon';this._createButton(this.options.title,aI,aK,aJ,this.toggleFullScreen,this);this._map.fullscreenControl=this;this._map.on('enterFullscreen exitFullscreen',this._toggleState,this);return aJ},onRemove(){A.DomEvent.off(this.link,'click',A.DomEvent.stop).off(this.link,'click',this.toggleFullScreen,this);this._screenfull.isEnabled&&(A.DomEvent.off(this._container,this._screenfull.nativeAPI.fullscreenchange,A.DomEvent.stop).off(this._container,this._screenfull.nativeAPI.fullscreenchange,this._handleFullscreenChange,this),A.DomEvent.off(document,this._screenfull.nativeAPI.fullscreenchange,A.DomEvent.stop).off(document,this._screenfull.nativeAPI.fullscreenchange,this._handleFullscreenChange,this))},_createButton(aL,aM,aN,aO,_e,f){this.link=A.DomUtil.create('a',aM,aO);this.link.href='#';this.link.title=aL;this.link.innerHTML=aN;this.link.setAttribute('role','button');this.link.setAttribute('aria-label',aL);L.DomEvent.disableClickPropagation(aO);A.DomEvent.on(this.link,'click',A.DomEvent.stop).on(this.link,'click',_e,f);this._screenfull.isEnabled&&(A.DomEvent.on(aO,this._screenfull.nativeAPI.fullscreenchange,A.DomEvent.stop).on(aO,this._screenfull.nativeAPI.fullscreenchange,this._handleFullscreenChange,f),A.DomEvent.on(document,this._screenfull.nativeAPI.fullscreenchange,A.DomEvent.stop).on(document,this._screenfull.nativeAPI.fullscreenchange,this._handleFullscreenChange,f));return this.link},toggleFullScreen(){var aP=this._map;aP._exitFired=!1;if(aP._isFullscreen){this._screenfull.isEnabled&&!this.options.forcePseudoFullscreen?this._screenfull.exit().then(()=>aP.invalidateSize()):A.DomUtil.removeClass(this.options.fullscreenElement||aP._container,'leaflet-pseudo-fullscreen');aP.fire('exitFullscreen');aP._exitFired=!0;aP._isFullscreen=!1}else{this._screenfull.isEnabled&&!this.options.forcePseudoFullscreen?this._screenfull.request(this.options.fullscreenElement||aP._container).then(()=>aP.invalidateSize()):A.DomUtil.addClass(this.options.fullscreenElement||aP._container,'leaflet-pseudo-fullscreen');aP.fire('enterFullscreen');aP._isFullscreen=!0}},_toggleState(){this.link.title=this._map._isFullscreen?this.options.title:this.options.titleCancel;this._map._isFullscreen?L.DomUtil.removeClass(this.link,'leaflet-fullscreen-on'):L.DomUtil.addClass(this.link,'leaflet-fullscreen-on')},_handleFullscreenChange(aQ){var aR=this._map;(aQ.target===aR.getContainer()&&!this._screenfull.isFullscreen&&!aR._exitFired)&&(this._screenfull.exit().then(()=>aR.invalidateSize()),aR.fire('exitFullscreen'),aR._exitFired=!0,aR._isFullscreen=!1)}});A.Map.include({toggleFullscreen(){this.fullscreenControl.toggleFullScreen()}});A.Map.addInitHook(function(){this.options.fullscreenControl&&this.addControl(A.control.fullscreen(this.options.fullscreenControlOptions))});A.control.fullscreen=aS=>new A.Control.FullScreen(aS);return{leaflet:A}});
